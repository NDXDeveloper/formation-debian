# 1.3 Post-installation

*Guide dÃ©butant - DurÃ©e estimÃ©e : 2h30*

---

## ğŸ¯ Objectifs de cette section

Ã€ la fin de cette section, vous saurez :
- Effectuer la configuration initiale optimale aprÃ¨s installation
- CrÃ©er et gÃ©rer des utilisateurs et groupes systÃ¨me
- Configurer et sÃ©curiser les droits sudo
- Maintenir votre systÃ¨me Ã  jour efficacement
- Appliquer les bonnes pratiques de sÃ©curitÃ© de base

---

## 1.3.1 Premier dÃ©marrage et configuration initiale

### ğŸš€ Que faire aprÃ¨s la premiÃ¨re connexion ?

FÃ©licitations ! Votre Debian est installÃ©, mais ce n'est que le dÃ©but. Comme une voiture neuve qui sort du garage, votre systÃ¨me a besoin de quelques rÃ©glages pour Ãªtre parfaitement opÃ©rationnel.

#### Les prioritÃ©s du premier dÃ©marrage

1. **VÃ©rifier que tout fonctionne** âœ…
2. **SÃ©curiser le systÃ¨me** ğŸ”’
3. **Mettre Ã  jour** ğŸ”„
4. **Personnaliser** ğŸ¨
5. **Installer les outils essentiels** ğŸ› ï¸

### ğŸ” Diagnostic initial du systÃ¨me

#### VÃ©rifications automatiques post-installation

```bash
# Ouvrir un terminal (Ctrl + Alt + T)

# VÃ©rifier l'identitÃ© du systÃ¨me
hostnamectl
# RÃ©sultat : Informations complÃ¨tes sur votre systÃ¨me

# VÃ©rifier l'Ã©tat gÃ©nÃ©ral
systemctl status
# RÃ©sultat : Ã‰tat des services principaux

# VÃ©rifier l'espace disque
df -h /
# RÃ©sultat : Utilisation de la partition racine

# VÃ©rifier la mÃ©moire
free -h
# RÃ©sultat : Utilisation de la RAM
```

#### Informations systÃ¨me importantes

```bash
# Version exacte de Debian
cat /etc/debian_version
# Exemple : 12.4

# Informations dÃ©taillÃ©es
lsb_release -a
# RÃ©sultat complet : Debian 12 "Bookworm"

# Architecture du processeur
uname -m
# RÃ©sultat : x86_64 (64 bits)

# Noyau Linux utilisÃ©
uname -r
# Exemple : 6.1.0-18-amd64
```

### ğŸŒ Configuration rÃ©seau avancÃ©e

#### VÃ©rifier la configuration automatique

```bash
# Voir toutes les interfaces rÃ©seau
ip addr show
# Observer : eth0, enp0s3, ou wlan0

# Voir la configuration DNS
cat /etc/resolv.conf
# VÃ©rifier : Serveurs DNS configurÃ©s

# Tester la connectivitÃ© complÃ¨te
ping -c 3 8.8.8.8  # Test IP pure
ping -c 3 google.com  # Test rÃ©solution DNS
```

#### Configuration WiFi (si nÃ©cessaire)

**Via l'interface graphique** :
1. Clic sur l'icÃ´ne rÃ©seau (coin supÃ©rieur droit)
2. "ParamÃ¨tres WiFi"
3. SÃ©lectionner votre rÃ©seau
4. Saisir la clÃ© WiFi

**Via la ligne de commande** :
```bash
# Lister les rÃ©seaux WiFi disponibles
sudo iwlist scan | grep ESSID

# Se connecter Ã  un rÃ©seau (mÃ©thode simple)
sudo nmcli dev wifi connect "NomDuReseau" password "MotDePasse"

# VÃ©rifier la connexion
nmcli connection show
```

### ğŸ•’ Configuration de l'heure et localisation

#### VÃ©rifier et ajuster le fuseau horaire

```bash
# Voir le fuseau horaire actuel
timedatectl
# RÃ©sultat : Timezone, heure locale et UTC

# Lister les fuseaux horaires disponibles
timedatectl list-timezones | grep Europe
# Trouver : Europe/Paris, Europe/London, etc.

# Changer si nÃ©cessaire
sudo timedatectl set-timezone Europe/Paris

# Synchroniser avec Internet
sudo timedatectl set-ntp true
```

#### Configuration des formats rÃ©gionaux

```bash
# Voir la configuration locale actuelle
locale
# RÃ©sultat : Variables LANG, LC_TIME, etc.

# Lister les locales disponibles
locale -a | grep fr_FR

# Reconfigurer si nÃ©cessaire
sudo dpkg-reconfigure locales
```

### ğŸ–¥ï¸ Optimisation de l'affichage

#### RÃ©solution et Ã©chelle d'Ã©cran

**Via GNOME** :
1. ParamÃ¨tres â†’ Affichage
2. Ajuster la rÃ©solution
3. Modifier l'Ã©chelle si texte trop petit/grand
4. Tester et appliquer

**Via ligne de commande** :
```bash
# Voir les rÃ©solutions disponibles
xrandr
# RÃ©sultat : Liste des modes d'affichage

# Changer la rÃ©solution (exemple)
xrandr --output Virtual-1 --mode 1920x1080
```

#### Configuration des polices

```bash
# Installer des polices supplÃ©mentaires
sudo apt update
sudo apt install fonts-liberation fonts-dejavu-extra

# VÃ©rifier les polices installÃ©es
fc-list | head -10
```

---

## 1.3.2 Gestion des utilisateurs et groupes

### ğŸ‘¥ Comprendre les utilisateurs Linux

#### Les types d'utilisateurs

**Utilisateur root (UID 0)** :
- **RÃ´le** : Administrateur systÃ¨me tout-puissant
- **Pouvoirs** : Peut tout faire, tout modifier, tout casser
- **Analogie** : PDG d'une entreprise avec tous les pouvoirs
- **Usage** : Uniquement pour l'administration systÃ¨me

**Utilisateurs normaux (UID â‰¥ 1000)** :
- **RÃ´le** : Utilisateurs quotidiens du systÃ¨me
- **Pouvoirs** : LimitÃ©s Ã  leur dossier personnel et applications
- **Analogie** : EmployÃ©s avec des permissions spÃ©cifiques
- **Usage** : Travail quotidien, navigation, bureautique

**Utilisateurs systÃ¨me (UID 1-999)** :
- **RÃ´le** : Services et dÃ©mons systÃ¨me
- **Exemples** : www-data (Apache), mysql, mail
- **Usage** : Interne au systÃ¨me, pas de connexion directe

### ğŸ” Explorer les utilisateurs existants

```bash
# Voir tous les utilisateurs du systÃ¨me
cat /etc/passwd
# Format : nom:mot_de_passe:UID:GID:description:dossier:shell

# Voir seulement les utilisateurs "humains"
cat /etc/passwd | grep "/home"

# Voir l'utilisateur actuel
whoami
id
# RÃ©sultat : Votre nom et vos identifiants numÃ©riques

# Voir les groupes de l'utilisateur actuel
groups
# Exemple : jean adm cdrom sudo dip plugdev users
```

### ğŸ‘¤ CrÃ©er de nouveaux utilisateurs

#### MÃ©thode recommandÃ©e : adduser

```bash
# CrÃ©er un nouvel utilisateur (en tant que root ou avec sudo)
sudo adduser marie
# L'assistant vous guide :
# - Mot de passe
# - Nom complet
# - NumÃ©ro de tÃ©lÃ©phone (optionnel)
# - Etc.

# VÃ©rifier la crÃ©ation
sudo cat /etc/passwd | grep marie
ls -la /home/
# Observer : Dossier /home/marie crÃ©Ã© automatiquement
```

#### MÃ©thode avancÃ©e : useradd

```bash
# CrÃ©ation manuelle complÃ¨te
sudo useradd -m -s /bin/bash -c "Marie Martin" marie
# -m : CrÃ©er le dossier home
# -s : Shell par dÃ©faut
# -c : Commentaire (nom complet)

# DÃ©finir un mot de passe
sudo passwd marie
# Saisir et confirmer le mot de passe
```

### ğŸ·ï¸ Comprendre et gÃ©rer les groupes

#### Qu'est-ce qu'un groupe ?

**Analogie** : Un groupe est comme un "club" ou une "Ã©quipe" dans une entreprise. Chaque club a des permissions spÃ©cifiques.

**Exemples de groupes importants** :
- **sudo** : Peut utiliser la commande sudo (administrateurs)
- **adm** : Peut lire les logs systÃ¨me
- **cdrom** : Peut utiliser les lecteurs CD/DVD
- **audio** : Peut utiliser les pÃ©riphÃ©riques audio
- **video** : Peut utiliser les pÃ©riphÃ©riques vidÃ©o
- **plugdev** : Peut monter des pÃ©riphÃ©riques USB

#### Gestion des groupes

```bash
# Voir tous les groupes du systÃ¨me
cat /etc/group

# Voir les groupes d'un utilisateur spÃ©cifique
groups marie

# CrÃ©er un nouveau groupe
sudo groupadd developpeurs

# Ajouter un utilisateur Ã  un groupe
sudo usermod -aG developpeurs marie
# -a : Ajouter (sans enlever des autres groupes)
# -G : Groupes secondaires

# Retirer un utilisateur d'un groupe
sudo deluser marie cdrom
```

### ğŸ”§ Modifier les utilisateurs existants

#### Changements courants

```bash
# Changer le nom complet (GECOS)
sudo usermod -c "Marie Martin-Dupont" marie

# Changer le shell par dÃ©faut
sudo usermod -s /bin/zsh marie

# Changer le dossier home
sudo usermod -d /home/marie_new marie

# Verrouiller un compte temporairement
sudo usermod -L marie
# DÃ©verrouiller
sudo usermod -U marie
```

#### Changer les mots de passe

```bash
# Changer son propre mot de passe
passwd
# Saisir l'ancien puis le nouveau

# Changer le mot de passe d'un autre utilisateur (sudo requis)
sudo passwd marie

# Forcer le changement au prochain login
sudo passwd -e marie
```

### ğŸ—‘ï¸ Supprimer des utilisateurs

#### Suppression simple

```bash
# Supprimer un utilisateur mais garder son dossier home
sudo deluser marie

# Supprimer un utilisateur ET son dossier home
sudo deluser --remove-home marie

# Supprimer complÃ¨tement (utilisateur + home + mail)
sudo deluser --remove-all-files marie
```

#### âš ï¸ PrÃ©cautions importantes

```bash
# TOUJOURS vÃ©rifier avant suppression
# 1. Voir les processus de l'utilisateur
ps aux | grep marie

# 2. Voir les fichiers appartenant Ã  l'utilisateur
sudo find / -user marie 2>/dev/null

# 3. Sauvegarder les donnÃ©es importantes
sudo cp -r /home/marie /backup/marie-$(date +%Y%m%d)
```

---

## 1.3.3 Configuration de sudo

### ğŸ” Qu'est-ce que sudo ?

#### Principe de fonctionnement

**sudo** = "**S**ubstitute **U**ser **DO**" (ou "**S**uper **U**ser **DO**")

**Analogie** : sudo est comme un badge d'accÃ¨s temporaire dans une entreprise. Au lieu de donner les clÃ©s du bureau du directeur Ã  tous les employÃ©s, on leur donne un badge qui permet d'y accÃ©der temporairement quand nÃ©cessaire.

#### Avantages par rapport Ã  root direct

| Aspect | Connexion root | sudo |
|--------|----------------|------|
| **SÃ©curitÃ©** | TrÃ¨s risquÃ© | SÃ©curisÃ© |
| **TraÃ§abilitÃ©** | LimitÃ©e | ComplÃ¨te |
| **GranularitÃ©** | Tout ou rien | Permissions ciblÃ©es |
| **DurÃ©e** | Session complÃ¨te | Commande par commande |

### ğŸ“‹ VÃ©rifier la configuration sudo actuelle

```bash
# VÃ©rifier si vous avez les droits sudo
sudo whoami
# RÃ©sultat attendu : root

# Voir votre configuration sudo
sudo -l
# RÃ©sultat : Liste des commandes autorisÃ©es

# Voir les membres du groupe sudo
getent group sudo
# RÃ©sultat : sudo:x:27:votre-nom
```

### âš™ï¸ Configuration du fichier sudoers

#### Le fichier /etc/sudoers

**âš ï¸ ATTENTION** : Ne JAMAIS Ã©diter directement /etc/sudoers !
**Toujours utiliser** : `sudo visudo`

```bash
# Ã‰diter la configuration sudo de maniÃ¨re sÃ©curisÃ©e
sudo visudo
```

#### Comprendre la syntaxe de base

```bash
# Format gÃ©nÃ©ral :
# utilisateur hÃ´te=(utilisateur_cible) commandes

# Exemples dans /etc/sudoers :
%sudo   ALL=(ALL:ALL) ALL
# %sudo : Groupe sudo
# ALL : Tous les hÃ´tes
# (ALL:ALL) : Peut devenir n'importe quel utilisateur/groupe
# ALL : Peut exÃ©cuter toutes les commandes
```

### ğŸ¯ Configurations sudo courantes

#### Donner tous les droits Ã  un utilisateur

```bash
# Ajouter Ã  la fin du fichier (via visudo)
marie ALL=(ALL:ALL) ALL
```

#### Autoriser des commandes spÃ©cifiques

```bash
# Permettre seulement la gestion des services
marie ALL=(ALL) /bin/systemctl

# Permettre plusieurs commandes spÃ©cifiques
marie ALL=(ALL) /bin/systemctl, /sbin/reboot, /sbin/shutdown

# Permettre apt sans mot de passe
marie ALL=(ALL) NOPASSWD: /usr/bin/apt, /usr/bin/apt-get
```

#### CrÃ©er des groupes personnalisÃ©s

```bash
# Dans visudo, crÃ©er des alias
Cmnd_Alias SERVICES = /bin/systemctl, /sbin/service
Cmnd_Alias NETWORK = /sbin/ifconfig, /bin/netstat

# Puis les utiliser
%admin ALL=(ALL) SERVICES, NETWORK
```

### ğŸ”’ SÃ©curiser sudo

#### Bonnes pratiques de sÃ©curitÃ©

```bash
# Dans visudo, ajouter des options de sÃ©curitÃ© :

# Exiger le mot de passe pour chaque sudo (par dÃ©faut)
Defaults timestamp_timeout=0

# Logger toutes les commandes sudo
Defaults logfile="/var/log/sudo.log"

# Envoyer un mail en cas de tentative non autorisÃ©e
Defaults mailto="admin@example.com"
Defaults mail_badpass, mail_no_user, mail_no_perms
```

#### Tester la configuration

```bash
# VÃ©rifier la syntaxe avant de sauvegarder
sudo visudo -c
# RÃ©sultat : /etc/sudoers: parsed OK

# Tester avec un autre terminal (garder celui-ci ouvert !)
# Dans un nouveau terminal :
sudo whoami
sudo systemctl status ssh
```

### ğŸ“Š Surveillance et logs sudo

#### Voir l'historique des commandes sudo

```bash
# Logs dans le journal systÃ¨me
sudo journalctl | grep sudo

# Logs dÃ©taillÃ©s (si configurÃ©)
sudo tail -f /var/log/sudo.log

# Logs d'authentification
sudo tail -f /var/log/auth.log | grep sudo
```

#### Exemple de log sudo

```
Jan 15 10:30:15 debian marie : TTY=pts/0 ; PWD=/home/marie ;
USER=root ; COMMAND=/usr/bin/apt update
```

**InterprÃ©tation** :
- **Qui** : marie
- **Quand** : 15 janvier Ã  10h30
- **OÃ¹** : Terminal pts/0
- **Depuis** : Dossier /home/marie
- **Quoi** : Commande apt update en tant que root

---

## 1.3.4 Mise Ã  jour du systÃ¨me

### ğŸ”„ Pourquoi mettre Ã  jour ?

#### Types de mises Ã  jour

**Mises Ã  jour de sÃ©curitÃ©** ğŸ›¡ï¸ :
- **PrioritÃ©** : CRITIQUE
- **FrÃ©quence** : DÃ¨s que disponibles
- **Exemple** : Correction faille SSH, navigateur web

**Mises Ã  jour de bugs** ğŸ› :
- **PrioritÃ©** : Importante
- **FrÃ©quence** : RÃ©guliÃ¨re (hebdomadaire)
- **Exemple** : Correction plantage application

**Nouvelles fonctionnalitÃ©s** âœ¨ :
- **PrioritÃ©** : Optionnelle
- **FrÃ©quence** : Ã€ votre convenance
- **Exemple** : Nouvelle version LibreOffice

### ğŸ“¦ Le systÃ¨me APT en dÃ©tail

#### Les commandes essentielles

```bash
# 1. Mettre Ã  jour la liste des paquets disponibles
sudo apt update
# Lit les dÃ©pÃ´ts, tÃ©lÃ©charge les listes de paquets
# DurÃ©e : 10-30 secondes

# 2. Voir les mises Ã  jour disponibles
apt list --upgradable
# Liste tous les paquets qui peuvent Ãªtre mis Ã  jour

# 3. Mettre Ã  jour tous les paquets
sudo apt upgrade
# Met Ã  jour sans changer les dÃ©pendances

# 4. Mise Ã  jour complÃ¨te (avec nouvelles dÃ©pendances)
sudo apt full-upgrade
# Peut installer/supprimer des paquets si nÃ©cessaire
```

#### Comprendre la diffÃ©rence upgrade vs full-upgrade

**apt upgrade** :
- Met Ã  jour les paquets existants
- N'installe jamais de nouveaux paquets
- N'en supprime jamais
- **Usage** : Mise Ã  jour de routine, sÃ©curisÃ©e

**apt full-upgrade** :
- Met Ã  jour les paquets existants
- Peut installer de nouveaux paquets (dÃ©pendances)
- Peut supprimer des paquets obsolÃ¨tes
- **Usage** : Mise Ã  jour majeure, plus complÃ¨te

### ğŸ¯ StratÃ©gies de mise Ã  jour

#### Mise Ã  jour quotidienne simple

```bash
# Routine recommandÃ©e pour dÃ©butants
sudo apt update && sudo apt upgrade
```

#### Mise Ã  jour avec vÃ©rification

```bash
# Version prudente avec validation
sudo apt update
apt list --upgradable
# Examiner la liste
sudo apt upgrade
```

#### Automatisation des mises Ã  jour de sÃ©curitÃ©

```bash
# Installer le paquet de mise Ã  jour automatique
sudo apt install unattended-upgrades

# Configurer pour les mises Ã  jour de sÃ©curitÃ© seulement
sudo dpkg-reconfigure unattended-upgrades
# RÃ©pondre "Oui" pour activer

# VÃ©rifier la configuration
cat /etc/apt/apt.conf.d/20auto-upgrades
```

### ğŸ§¹ Nettoyage du systÃ¨me

#### Supprimer les paquets inutiles

```bash
# Supprimer les paquets orphelins
sudo apt autoremove
# Supprime les paquets installÃ©s automatiquement mais plus nÃ©cessaires

# Nettoyer le cache des paquets tÃ©lÃ©chargÃ©s
sudo apt autoclean
# Supprime les anciens fichiers .deb du cache

# Nettoyage complet du cache
sudo apt clean
# Supprime TOUS les fichiers .deb du cache
```

#### Voir l'espace libÃ©rÃ©

```bash
# Avant nettoyage
df -h /var/cache/apt/archives/

# AprÃ¨s nettoyage
sudo apt clean
df -h /var/cache/apt/archives/

# Voir l'espace total utilisÃ© par apt
du -sh /var/cache/apt/archives/
```

### ğŸ” Gestion avancÃ©e des paquets

#### Rechercher des paquets

```bash
# Rechercher par nom
apt search firefox

# Rechercher par description
apt search "text editor"

# Informations dÃ©taillÃ©es sur un paquet
apt show firefox-esr

# Voir les dÃ©pendances d'un paquet
apt depends firefox-esr
```

#### Installer/supprimer des paquets

```bash
# Installer un paquet
sudo apt install nom-du-paquet

# Installer plusieurs paquets
sudo apt install paquet1 paquet2 paquet3

# Supprimer un paquet (garder configuration)
sudo apt remove nom-du-paquet

# Supprimer complÃ¨tement (avec configuration)
sudo apt purge nom-du-paquet
```

### ğŸ“… Planification des mises Ã  jour

#### CrÃ©er une routine hebdomadaire

```bash
# CrÃ©er un script de mise Ã  jour
sudo nano /usr/local/bin/weekly-update.sh

#!/bin/bash
# Script de mise Ã  jour hebdomadaire
echo "=== Mise Ã  jour du systÃ¨me $(date) ==="
apt update
echo "Paquets Ã  mettre Ã  jour :"
apt list --upgradable
echo "DÃ©but de la mise Ã  jour..."
apt upgrade -y
apt autoremove -y
apt autoclean
echo "=== Mise Ã  jour terminÃ©e ==="

# Rendre le script exÃ©cutable
sudo chmod +x /usr/local/bin/weekly-update.sh

# Tester le script
sudo /usr/local/bin/weekly-update.sh
```

---

## ğŸ‰ FÃ©licitations !

### Ce que vous avez accompli

ğŸ¯ **Configuration complÃ¨te** : SystÃ¨me Debian optimisÃ© et sÃ©curisÃ©
ğŸ‘¥ **Gestion utilisateurs** : MaÃ®trise des comptes et permissions
ğŸ” **SÃ©curisation avancÃ©e** : Pare-feu, SSH, fail2ban configurÃ©s
ğŸ”„ **Maintenance automatisÃ©e** : Scripts et tÃ¢ches cron opÃ©rationnels
ğŸ“Š **Monitoring** : Outils de surveillance et diagnostic en place

### CompÃ©tences acquises

âœ… **Administration systÃ¨me** : Concepts fondamentaux maÃ®trisÃ©s
âœ… **SÃ©curitÃ© de base** : Bonnes pratiques appliquÃ©es
âœ… **Automatisation** : Scripts de maintenance crÃ©Ã©s
âœ… **DÃ©pannage** : MÃ©thodes de diagnostic apprises
âœ… **Documentation** : Rapports et logs structurÃ©s

### Prochaines Ã©tapes recommandÃ©es

1. **Pratique rÃ©guliÃ¨re** : Utilisez quotidiennement votre systÃ¨me
2. **Veille sÃ©curitÃ©** : Surveillez les alertes de sÃ©curitÃ© Debian
3. **Sauvegarde** : Mettez en place une stratÃ©gie de sauvegarde
4. **Approfondissement** : Explorez les modules suivants de la formation
5. **Documentation** : Tenez Ã  jour vos procÃ©dures personnelles

### Ressources pour aller plus loin

- **Debian Security** : https://www.debian.org/security/
- **Guide administrateur** : https://debian-handbook.info/
- **Forums communautÃ©** : https://debian-facile.org/
- **Documentation sudo** : https://www.sudo.ws/docs/

---

## ğŸ“ Notes personnelles de configuration

*Espace pour vos observations et personnalisations :*

**Configurations spÃ©cifiques appliquÃ©es** :
- Port SSH utilisÃ© : ___________
- Utilisateurs crÃ©Ã©s : ___________
- Groupes personnalisÃ©s : ___________

**Scripts personnalisÃ©s** :
- Localisation des scripts : ___________
- Modifications apportÃ©es : ___________
- TÃ¢ches cron configurÃ©es : ___________

**Points Ã  retenir** :
- Commandes les plus utiles : ___________
- ProblÃ¨mes rencontrÃ©s et solutions : ___________
- AmÃ©liorations Ã  apporter : ___________

---

*ğŸ’¡ **Conseil final** : Votre systÃ¨me Debian est maintenant solidement configurÃ© et sÃ©curisÃ©. Prenez l'habitude de consulter rÃ©guliÃ¨rement vos scripts de monitoring et de tenir Ã  jour votre documentation. Cette base solide vous permettra d'aborder sereinement les modules plus avancÃ©s de la formation.*

**ğŸ¯ PrÃªt pour le Module 2 : Debian Desktop !**
