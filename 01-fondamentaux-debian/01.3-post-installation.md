# 1.3 Post-installation

*Guide d√©butant - Dur√©e estim√©e : 2h30*

---

## üéØ Objectifs de cette section

√Ä la fin de cette section, vous saurez :
- Effectuer la configuration initiale optimale apr√®s installation
- Cr√©er et g√©rer des utilisateurs et groupes syst√®me
- Configurer et s√©curiser les droits sudo
- Maintenir votre syst√®me √† jour efficacement
- Appliquer les bonnes pratiques de s√©curit√© de base

---

## 1.3.1 Premier d√©marrage et configuration initiale

### üöÄ Que faire apr√®s la premi√®re connexion ?

F√©licitations ! Votre Debian est install√©, mais ce n'est que le d√©but. Comme une voiture neuve qui sort du garage, votre syst√®me a besoin de quelques r√©glages pour √™tre parfaitement op√©rationnel.

#### Les priorit√©s du premier d√©marrage

1. **V√©rifier que tout fonctionne** ‚úÖ
2. **S√©curiser le syst√®me** üîí
3. **Mettre √† jour** üîÑ
4. **Personnaliser** üé®
5. **Installer les outils essentiels** üõ†Ô∏è

### üîç Diagnostic initial du syst√®me

#### V√©rifications automatiques post-installation

```bash
# Ouvrir un terminal (Ctrl + Alt + T)

# V√©rifier l'identit√© du syst√®me
hostnamectl
# R√©sultat : Informations compl√®tes sur votre syst√®me

# V√©rifier l'√©tat g√©n√©ral
systemctl status
# R√©sultat : √âtat des services principaux

# V√©rifier l'espace disque
df -h /
# R√©sultat : Utilisation de la partition racine

# V√©rifier la m√©moire
free -h
# R√©sultat : Utilisation de la RAM
```

#### Informations syst√®me importantes

```bash
# Version exacte de Debian
cat /etc/debian_version
# Exemple : 12.4

# Informations d√©taill√©es
lsb_release -a
# R√©sultat complet : Debian 12 "Bookworm"

# Architecture du processeur
uname -m
# R√©sultat : x86_64 (64 bits)

# Noyau Linux utilis√©
uname -r
# Exemple : 6.1.0-18-amd64
```

### üåê Configuration r√©seau avanc√©e

#### V√©rifier la configuration automatique

```bash
# Voir toutes les interfaces r√©seau
ip addr show
# Observer : eth0, enp0s3, ou wlan0

# Voir la configuration DNS
cat /etc/resolv.conf
# V√©rifier : Serveurs DNS configur√©s

# Tester la connectivit√© compl√®te
ping -c 3 8.8.8.8  # Test IP pure
ping -c 3 google.com  # Test r√©solution DNS
```

#### Configuration WiFi (si n√©cessaire)

**Via l'interface graphique** :
1. Clic sur l'ic√¥ne r√©seau (coin sup√©rieur droit)
2. "Param√®tres WiFi"
3. S√©lectionner votre r√©seau
4. Saisir la cl√© WiFi

**Via la ligne de commande** :
```bash
# Lister les r√©seaux WiFi disponibles
sudo iwlist scan | grep ESSID

# Se connecter √† un r√©seau (m√©thode simple)
sudo nmcli dev wifi connect "NomDuReseau" password "MotDePasse"

# V√©rifier la connexion
nmcli connection show
```

### üïí Configuration de l'heure et localisation

#### V√©rifier et ajuster le fuseau horaire

```bash
# Voir le fuseau horaire actuel
timedatectl
# R√©sultat : Timezone, heure locale et UTC

# Lister les fuseaux horaires disponibles
timedatectl list-timezones | grep Europe
# Trouver : Europe/Paris, Europe/London, etc.

# Changer si n√©cessaire
sudo timedatectl set-timezone Europe/Paris

# Synchroniser avec Internet
sudo timedatectl set-ntp true
```

#### Configuration des formats r√©gionaux

```bash
# Voir la configuration locale actuelle
locale
# R√©sultat : Variables LANG, LC_TIME, etc.

# Lister les locales disponibles
locale -a | grep fr_FR

# Reconfigurer si n√©cessaire
sudo dpkg-reconfigure locales
```

### üñ•Ô∏è Optimisation de l'affichage

#### R√©solution et √©chelle d'√©cran

**Via GNOME** :
1. Param√®tres ‚Üí Affichage
2. Ajuster la r√©solution
3. Modifier l'√©chelle si texte trop petit/grand
4. Tester et appliquer

**Via ligne de commande** :
```bash
# Voir les r√©solutions disponibles
xrandr
# R√©sultat : Liste des modes d'affichage

# Changer la r√©solution (exemple)
xrandr --output Virtual-1 --mode 1920x1080
```

#### Configuration des polices

```bash
# Installer des polices suppl√©mentaires
sudo apt update
sudo apt install fonts-liberation fonts-dejavu-extra

# V√©rifier les polices install√©es
fc-list | head -10
```

---

## 1.3.2 Gestion des utilisateurs et groupes

### üë• Comprendre les utilisateurs Linux

#### Les types d'utilisateurs

**Utilisateur root (UID 0)** :
- **R√¥le** : Administrateur syst√®me tout-puissant
- **Pouvoirs** : Peut tout faire, tout modifier, tout casser
- **Analogie** : PDG d'une entreprise avec tous les pouvoirs
- **Usage** : Uniquement pour l'administration syst√®me

**Utilisateurs normaux (UID ‚â• 1000)** :
- **R√¥le** : Utilisateurs quotidiens du syst√®me
- **Pouvoirs** : Limit√©s √† leur dossier personnel et applications
- **Analogie** : Employ√©s avec des permissions sp√©cifiques
- **Usage** : Travail quotidien, navigation, bureautique

**Utilisateurs syst√®me (UID 1-999)** :
- **R√¥le** : Services et d√©mons syst√®me
- **Exemples** : www-data (Apache), mysql, mail
- **Usage** : Interne au syst√®me, pas de connexion directe

### üîç Explorer les utilisateurs existants

```bash
# Voir tous les utilisateurs du syst√®me
cat /etc/passwd
# Format : nom:mot_de_passe:UID:GID:description:dossier:shell

# Voir seulement les utilisateurs "humains"
cat /etc/passwd | grep "/home"

# Voir l'utilisateur actuel
whoami
id
# R√©sultat : Votre nom et vos identifiants num√©riques

# Voir les groupes de l'utilisateur actuel
groups
# Exemple : jean adm cdrom sudo dip plugdev users
```

### üë§ Cr√©er de nouveaux utilisateurs

#### M√©thode recommand√©e : adduser

```bash
# Cr√©er un nouvel utilisateur (en tant que root ou avec sudo)
sudo adduser marie
# L'assistant vous guide :
# - Mot de passe
# - Nom complet
# - Num√©ro de t√©l√©phone (optionnel)
# - Etc.

# V√©rifier la cr√©ation
sudo cat /etc/passwd | grep marie
ls -la /home/
# Observer : Dossier /home/marie cr√©√© automatiquement
```

#### M√©thode avanc√©e : useradd

```bash
# Cr√©ation manuelle compl√®te
sudo useradd -m -s /bin/bash -c "Marie Martin" marie
# -m : Cr√©er le dossier home
# -s : Shell par d√©faut
# -c : Commentaire (nom complet)

# D√©finir un mot de passe
sudo passwd marie
# Saisir et confirmer le mot de passe
```

### üè∑Ô∏è Comprendre et g√©rer les groupes

#### Qu'est-ce qu'un groupe ?

**Analogie** : Un groupe est comme un "club" ou une "√©quipe" dans une entreprise. Chaque club a des permissions sp√©cifiques.

**Exemples de groupes importants** :
- **sudo** : Peut utiliser la commande sudo (administrateurs)
- **adm** : Peut lire les logs syst√®me
- **cdrom** : Peut utiliser les lecteurs CD/DVD
- **audio** : Peut utiliser les p√©riph√©riques audio
- **video** : Peut utiliser les p√©riph√©riques vid√©o
- **plugdev** : Peut monter des p√©riph√©riques USB

#### Gestion des groupes

```bash
# Voir tous les groupes du syst√®me
cat /etc/group

# Voir les groupes d'un utilisateur sp√©cifique
groups marie

# Cr√©er un nouveau groupe
sudo groupadd developpeurs

# Ajouter un utilisateur √† un groupe
sudo usermod -aG developpeurs marie
# -a : Ajouter (sans enlever des autres groupes)
# -G : Groupes secondaires

# Retirer un utilisateur d'un groupe
sudo deluser marie cdrom
```

### üîß Modifier les utilisateurs existants

#### Changements courants

```bash
# Changer le nom complet (GECOS)
sudo usermod -c "Marie Martin-Dupont" marie

# Changer le shell par d√©faut
sudo usermod -s /bin/zsh marie

# Changer le dossier home
sudo usermod -d /home/marie_new marie

# Verrouiller un compte temporairement
sudo usermod -L marie
# D√©verrouiller
sudo usermod -U marie
```

#### Changer les mots de passe

```bash
# Changer son propre mot de passe
passwd
# Saisir l'ancien puis le nouveau

# Changer le mot de passe d'un autre utilisateur (sudo requis)
sudo passwd marie

# Forcer le changement au prochain login
sudo passwd -e marie
```

### üóëÔ∏è Supprimer des utilisateurs

#### Suppression simple

```bash
# Supprimer un utilisateur mais garder son dossier home
sudo deluser marie

# Supprimer un utilisateur ET son dossier home
sudo deluser --remove-home marie

# Supprimer compl√®tement (utilisateur + home + mail)
sudo deluser --remove-all-files marie
```

#### ‚ö†Ô∏è Pr√©cautions importantes

```bash
# TOUJOURS v√©rifier avant suppression
# 1. Voir les processus de l'utilisateur
ps aux | grep marie

# 2. Voir les fichiers appartenant √† l'utilisateur
sudo find / -user marie 2>/dev/null

# 3. Sauvegarder les donn√©es importantes
sudo cp -r /home/marie /backup/marie-$(date +%Y%m%d)
```

---

## 1.3.3 Configuration de sudo

### üîê Qu'est-ce que sudo ?

#### Principe de fonctionnement

**sudo** = "**S**ubstitute **U**ser **DO**" (ou "**S**uper **U**ser **DO**")

**Analogie** : sudo est comme un badge d'acc√®s temporaire dans une entreprise. Au lieu de donner les cl√©s du bureau du directeur √† tous les employ√©s, on leur donne un badge qui permet d'y acc√©der temporairement quand n√©cessaire.

#### Avantages par rapport √† root direct

| Aspect | Connexion root | sudo |
|--------|----------------|------|
| **S√©curit√©** | Tr√®s risqu√© | S√©curis√© |
| **Tra√ßabilit√©** | Limit√©e | Compl√®te |
| **Granularit√©** | Tout ou rien | Permissions cibl√©es |
| **Dur√©e** | Session compl√®te | Commande par commande |

### üìã V√©rifier la configuration sudo actuelle

```bash
# V√©rifier si vous avez les droits sudo
sudo whoami
# R√©sultat attendu : root

# Voir votre configuration sudo
sudo -l
# R√©sultat : Liste des commandes autoris√©es

# Voir les membres du groupe sudo
getent group sudo
# R√©sultat : sudo:x:27:votre-nom
```

### ‚öôÔ∏è Configuration du fichier sudoers

#### Le fichier /etc/sudoers

**‚ö†Ô∏è ATTENTION** : Ne JAMAIS √©diter directement /etc/sudoers !
**Toujours utiliser** : `sudo visudo`

```bash
# √âditer la configuration sudo de mani√®re s√©curis√©e
sudo visudo
```

#### Comprendre la syntaxe de base

```bash
# Format g√©n√©ral :
# utilisateur h√¥te=(utilisateur_cible) commandes

# Exemples dans /etc/sudoers :
%sudo   ALL=(ALL:ALL) ALL
# %sudo : Groupe sudo
# ALL : Tous les h√¥tes
# (ALL:ALL) : Peut devenir n'importe quel utilisateur/groupe
# ALL : Peut ex√©cuter toutes les commandes
```

### üéØ Configurations sudo courantes

#### Donner tous les droits √† un utilisateur

```bash
# Ajouter √† la fin du fichier (via visudo)
marie ALL=(ALL:ALL) ALL
```

#### Autoriser des commandes sp√©cifiques

```bash
# Permettre seulement la gestion des services
marie ALL=(ALL) /bin/systemctl

# Permettre plusieurs commandes sp√©cifiques
marie ALL=(ALL) /bin/systemctl, /sbin/reboot, /sbin/shutdown

# Permettre apt sans mot de passe
marie ALL=(ALL) NOPASSWD: /usr/bin/apt, /usr/bin/apt-get
```

#### Cr√©er des groupes personnalis√©s

```bash
# Dans visudo, cr√©er des alias
Cmnd_Alias SERVICES = /bin/systemctl, /sbin/service
Cmnd_Alias NETWORK = /sbin/ifconfig, /bin/netstat

# Puis les utiliser
%admin ALL=(ALL) SERVICES, NETWORK
```

### üîí S√©curiser sudo

#### Bonnes pratiques de s√©curit√©

```bash
# Dans visudo, ajouter des options de s√©curit√© :

# Exiger le mot de passe pour chaque sudo (par d√©faut)
Defaults timestamp_timeout=0

# Logger toutes les commandes sudo
Defaults logfile="/var/log/sudo.log"

# Envoyer un mail en cas de tentative non autoris√©e
Defaults mailto="admin@example.com"
Defaults mail_badpass, mail_no_user, mail_no_perms
```

#### Tester la configuration

```bash
# V√©rifier la syntaxe avant de sauvegarder
sudo visudo -c
# R√©sultat : /etc/sudoers: parsed OK

# Tester avec un autre terminal (garder celui-ci ouvert !)
# Dans un nouveau terminal :
sudo whoami
sudo systemctl status ssh
```

### üìä Surveillance et logs sudo

#### Voir l'historique des commandes sudo

```bash
# Logs dans le journal syst√®me
sudo journalctl | grep sudo

# Logs d√©taill√©s (si configur√©)
sudo tail -f /var/log/sudo.log

# Logs d'authentification
sudo tail -f /var/log/auth.log | grep sudo
```

#### Exemple de log sudo

```
Jan 15 10:30:15 debian marie : TTY=pts/0 ; PWD=/home/marie ;
USER=root ; COMMAND=/usr/bin/apt update
```

**Interpr√©tation** :
- **Qui** : marie
- **Quand** : 15 janvier √† 10h30
- **O√π** : Terminal pts/0
- **Depuis** : Dossier /home/marie
- **Quoi** : Commande apt update en tant que root

---

## 1.3.4 Mise √† jour du syst√®me

### üîÑ Pourquoi mettre √† jour ?

#### Types de mises √† jour

**Mises √† jour de s√©curit√©** üõ°Ô∏è :
- **Priorit√©** : CRITIQUE
- **Fr√©quence** : D√®s que disponibles
- **Exemple** : Correction faille SSH, navigateur web

**Mises √† jour de bugs** üêõ :
- **Priorit√©** : Importante
- **Fr√©quence** : R√©guli√®re (hebdomadaire)
- **Exemple** : Correction plantage application

**Nouvelles fonctionnalit√©s** ‚ú® :
- **Priorit√©** : Optionnelle
- **Fr√©quence** : √Ä votre convenance
- **Exemple** : Nouvelle version LibreOffice

### üì¶ Le syst√®me APT en d√©tail

#### Les commandes essentielles

```bash
# 1. Mettre √† jour la liste des paquets disponibles
sudo apt update
# Lit les d√©p√¥ts, t√©l√©charge les listes de paquets
# Dur√©e : 10-30 secondes

# 2. Voir les mises √† jour disponibles
apt list --upgradable
# Liste tous les paquets qui peuvent √™tre mis √† jour

# 3. Mettre √† jour tous les paquets
sudo apt upgrade
# Met √† jour sans changer les d√©pendances

# 4. Mise √† jour compl√®te (avec nouvelles d√©pendances)
sudo apt full-upgrade
# Peut installer/supprimer des paquets si n√©cessaire
```

#### Comprendre la diff√©rence upgrade vs full-upgrade

**apt upgrade** :
- Met √† jour les paquets existants
- N'installe jamais de nouveaux paquets
- N'en supprime jamais
- **Usage** : Mise √† jour de routine, s√©curis√©e

**apt full-upgrade** :
- Met √† jour les paquets existants
- Peut installer de nouveaux paquets (d√©pendances)
- Peut supprimer des paquets obsol√®tes
- **Usage** : Mise √† jour majeure, plus compl√®te

### üéØ Strat√©gies de mise √† jour

#### Mise √† jour quotidienne simple

```bash
# Routine recommand√©e pour d√©butants
sudo apt update && sudo apt upgrade
```

#### Mise √† jour avec v√©rification

```bash
# Version prudente avec validation
sudo apt update
apt list --upgradable
# Examiner la liste
sudo apt upgrade
```

#### Automatisation des mises √† jour de s√©curit√©

```bash
# Installer le paquet de mise √† jour automatique
sudo apt install unattended-upgrades

# Configurer pour les mises √† jour de s√©curit√© seulement
sudo dpkg-reconfigure unattended-upgrades
# R√©pondre "Oui" pour activer

# V√©rifier la configuration
cat /etc/apt/apt.conf.d/20auto-upgrades
```

### üßπ Nettoyage du syst√®me

#### Supprimer les paquets inutiles

```bash
# Supprimer les paquets orphelins
sudo apt autoremove
# Supprime les paquets install√©s automatiquement mais plus n√©cessaires

# Nettoyer le cache des paquets t√©l√©charg√©s
sudo apt autoclean
# Supprime les anciens fichiers .deb du cache

# Nettoyage complet du cache
sudo apt clean
# Supprime TOUS les fichiers .deb du cache
```

#### Voir l'espace lib√©r√©

```bash
# Avant nettoyage
df -h /var/cache/apt/archives/

# Apr√®s nettoyage
sudo apt clean
df -h /var/cache/apt/archives/

# Voir l'espace total utilis√© par apt
du -sh /var/cache/apt/archives/
```

### üîç Gestion avanc√©e des paquets

#### Rechercher des paquets

```bash
# Rechercher par nom
apt search firefox

# Rechercher par description
apt search "text editor"

# Informations d√©taill√©es sur un paquet
apt show firefox-esr

# Voir les d√©pendances d'un paquet
apt depends firefox-esr
```

#### Installer/supprimer des paquets

```bash
# Installer un paquet
sudo apt install nom-du-paquet

# Installer plusieurs paquets
sudo apt install paquet1 paquet2 paquet3

# Supprimer un paquet (garder configuration)
sudo apt remove nom-du-paquet

# Supprimer compl√®tement (avec configuration)
sudo apt purge nom-du-paquet
```

### üìÖ Planification des mises √† jour

#### Cr√©er une routine hebdomadaire

```bash
# Cr√©er un script de mise √† jour
sudo nano /usr/local/bin/weekly-update.sh

#!/bin/bash
# Script de mise √† jour hebdomadaire
echo "=== Mise √† jour du syst√®me $(date) ==="
apt update
echo "Paquets √† mettre √† jour :"
apt list --upgradable
echo "D√©but de la mise √† jour..."
apt upgrade -y
apt autoremove -y
apt autoclean
echo "=== Mise √† jour termin√©e ==="

# Rendre le script ex√©cutable
sudo chmod +x /usr/local/bin/weekly-update.sh

# Tester le script
sudo /usr/local/bin/weekly-update.sh
```

---

## üéâ F√©licitations !

### Ce que vous avez accompli

üéØ **Configuration compl√®te** : Syst√®me Debian optimis√© et s√©curis√©
üë• **Gestion utilisateurs** : Ma√Ætrise des comptes et permissions
üîê **S√©curisation avanc√©e** : Pare-feu, SSH, fail2ban configur√©s
üîÑ **Maintenance automatis√©e** : Scripts et t√¢ches cron op√©rationnels
üìä **Monitoring** : Outils de surveillance et diagnostic en place

### Comp√©tences acquises

‚úÖ **Administration syst√®me** : Concepts fondamentaux ma√Ætris√©s
‚úÖ **S√©curit√© de base** : Bonnes pratiques appliqu√©es
‚úÖ **Automatisation** : Scripts de maintenance cr√©√©s
‚úÖ **D√©pannage** : M√©thodes de diagnostic apprises
‚úÖ **Documentation** : Rapports et logs structur√©s

### Prochaines √©tapes recommand√©es

1. **Pratique r√©guli√®re** : Utilisez quotidiennement votre syst√®me
2. **Veille s√©curit√©** : Surveillez les alertes de s√©curit√© Debian
3. **Sauvegarde** : Mettez en place une strat√©gie de sauvegarde
4. **Approfondissement** : Explorez les modules suivants de la formation
5. **Documentation** : Tenez √† jour vos proc√©dures personnelles

### Ressources pour aller plus loin

- **Debian Security** : https://www.debian.org/security/
- **Guide administrateur** : https://debian-handbook.info/
- **Forums communaut√©** : https://debian-facile.org/
- **Documentation sudo** : https://www.sudo.ws/docs/

---

## üìù Notes personnelles de configuration

*Espace pour vos observations et personnalisations :*

**Configurations sp√©cifiques appliqu√©es** :
- Port SSH utilis√© : ___________
- Utilisateurs cr√©√©s : ___________
- Groupes personnalis√©s : ___________

**Scripts personnalis√©s** :
- Localisation des scripts : ___________
- Modifications apport√©es : ___________
- T√¢ches cron configur√©es : ___________

**Points √† retenir** :
- Commandes les plus utiles : ___________
- Probl√®mes rencontr√©s et solutions : ___________
- Am√©liorations √† apporter : ___________

---

*üí° **Conseil final** : Votre syst√®me Debian est maintenant solidement configur√© et s√©curis√©. Prenez l'habitude de consulter r√©guli√®rement vos scripts de monitoring et de tenir √† jour votre documentation. Cette base solide vous permettra d'aborder sereinement les modules plus avanc√©s de la formation.*

**üéØ Pr√™t pour le Module 2 : Debian Desktop !**
