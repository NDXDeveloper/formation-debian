üîù Retour au [Sommaire](/SOMMAIRE.md)

# 2.3 Mat√©riel et pilotes

*Guide d√©butant - Dur√©e estim√©e : 2h30*

---

## üéØ Objectifs de cette section

√Ä la fin de cette section, vous saurez :
- Identifier et installer les pilotes propri√©taires n√©cessaires
- Configurer la gestion de l'alimentation pour ordinateurs portables
- G√©rer les configurations multi-√©crans efficacement
- Configurer Bluetooth et connecter vos p√©riph√©riques
- Diagnostiquer et r√©soudre les probl√®mes mat√©riels courants

---

## üîß Comprendre les pilotes sous Linux

### Qu'est-ce qu'un pilote (driver) ?

Un **pilote** est un programme qui permet au syst√®me d'exploitation de communiquer avec un composant mat√©riel.

**Analogie simple** : Le pilote est comme un **traducteur** entre votre syst√®me (qui parle "Linux") et votre mat√©riel (qui parle "√©lectronique"). Sans traducteur, ils ne peuvent pas se comprendre !

### Types de pilotes sous Debian

#### Pilotes libres (open source)
- **Avantages** : ‚úÖ Inclus par d√©faut, stables, maintenus par la communaut√©
- **Inconv√©nients** : ‚ùå Parfois moins performants que les propri√©taires
- **Exemples** : Nouveau (NVIDIA), Radeon (AMD), Intel

#### Pilotes propri√©taires (closed source)
- **Avantages** : ‚úÖ Performances optimales, support complet du mat√©riel
- **Inconv√©nients** : ‚ùå Pas libres, installation manuelle, mises √† jour parfois probl√©matiques
- **Exemples** : NVIDIA officiels, Broadcom WiFi, certains pilotes audio

### üîç Identifier votre mat√©riel

#### Commandes essentielles de diagnostic

```bash
# Vue d'ensemble du mat√©riel
sudo lshw -short
# R√©sultat : Liste compl√®te des composants

# Informations d√©taill√©es CPU
lscpu
# R√©sultat : Processeur, architecture, cores...

# Carte graphique
lspci | grep -i vga
lspci | grep -i nvidia
# R√©sultat : Cartes graphiques d√©tect√©es

# P√©riph√©riques USB
lsusb
# R√©sultat : Tous les p√©riph√©riques USB connect√©s

# Informations r√©seau
lspci | grep -i network
lspci | grep -i wireless
# R√©sultat : Cartes r√©seau et WiFi

# Cr√©er un rapport mat√©riel complet
sudo lshw -html > ~/rapport-materiel.html
# Ouvrir avec : firefox ~/rapport-materiel.html
```

#### Script de diagnostic automatique

```bash
cat << 'EOF' > ~/diagnostic-materiel.sh
#!/bin/bash
echo "=== DIAGNOSTIC MAT√âRIEL COMPLET ==="
echo "Date: $(date)"
echo ""

echo "=== PROCESSEUR ==="
lscpu | grep -E "(Model name|Architecture|CPU\(s\)):"
echo ""

echo "=== M√âMOIRE ==="
free -h
echo ""

echo "=== STOCKAGE ==="
lsblk
echo ""

echo "=== CARTE GRAPHIQUE ==="
lspci | grep -i vga
lspci | grep -i nvidia
lspci | grep -i amd
echo ""

echo "=== R√âSEAU ==="
echo "Ethernet:"
lspci | grep -i ethernet
echo "WiFi:"
lspci | grep -i wireless
echo ""

echo "=== AUDIO ==="
lspci | grep -i audio
echo ""

echo "=== USB ==="
echo "Contr√¥leurs USB:"
lspci | grep -i usb
echo "P√©riph√©riques connect√©s:"
lsusb | head -10
echo ""

echo "=== PILOTES CHARG√âS ==="
echo "Pilotes graphiques actifs:"
lsmod | grep -E "(nvidia|nouveau|radeon|amdgpu|i915)"
echo ""
echo "Pilotes r√©seau actifs:"
lsmod | grep -E "(iwlwifi|b43|rtl|ath)"
EOF

chmod +x ~/diagnostic-materiel.sh
./diagnostic-materiel.sh
```

---

## 2.3.1 Installation de pilotes propri√©taires (NVIDIA, WiFi)

### üéÆ Pilotes graphiques NVIDIA

#### Pourquoi installer les pilotes NVIDIA propri√©taires ?

**Pilotes libres (Nouveau)** :
- ‚úÖ Install√©s automatiquement
- ‚úÖ Fonctionnement de base garanti
- ‚ùå Performances limit√©es pour les jeux et calculs
- ‚ùå Pas de support des nouvelles fonctionnalit√©s

**Pilotes propri√©taires NVIDIA** :
- ‚úÖ Performances maximales
- ‚úÖ Support CUDA pour calculs scientifiques
- ‚úÖ Support des derni√®res fonctionnalit√©s gaming
- ‚ùå Installation plus complexe
- ‚ùå Pas libres

#### V√©rification pr√©alable

```bash
# V√©rifier la pr√©sence d'une carte NVIDIA
lspci | grep -i nvidia
# Si rien ne s'affiche, vous n'avez pas de carte NVIDIA

# Voir le pilote actuellement utilis√©
lsmod | grep nvidia    # Pilote propri√©taire
lsmod | grep nouveau   # Pilote libre

# Voir les performances graphiques actuelles
glxinfo | grep -E "(OpenGL vendor|OpenGL renderer)"
```

#### Installation via APT (m√©thode recommand√©e)

```bash
# Activer les d√©p√¥ts non-free
sudo nano /etc/apt/sources.list
# Ajouter "non-free" √† la fin de chaque ligne, exemple :
# deb http://deb.debian.org/debian bookworm main non-free
# deb-src http://deb.debian.org/debian bookworm main non-free

# Mettre √† jour les listes
sudo apt update

# D√©tecter automatiquement le pilote recommand√©
sudo apt install nvidia-detect
nvidia-detect
# Suivre les recommandations affich√©es

# Installation du pilote (exemple pour cartes r√©centes)
sudo apt install nvidia-driver

# Pour les cartes plus anciennes
sudo apt install nvidia-legacy-390xx-driver

# Red√©marrer obligatoire
sudo reboot
```

#### V√©rification post-installation

```bash
# V√©rifier que le pilote NVIDIA est charg√©
nvidia-smi
# Doit afficher les informations de la carte

# Test des performances graphiques
glxinfo | grep "OpenGL renderer"
# Doit afficher le nom de votre carte NVIDIA

# Test 3D simple
glxgears
# Les engrenages doivent tourner fluidement
```

### üì∂ Pilotes WiFi propri√©taires

#### Probl√®mes WiFi courants

**Sympt√¥mes** :
- WiFi non d√©tect√© dans les param√®tres
- Carte r√©seau non visible avec `iwconfig`
- Connexions instables ou lentes

#### Identifier votre chipset WiFi

```bash
# Identifier la carte WiFi
lspci | grep -i wireless
# ou
lsusb | grep -i wireless

# Voir les pilotes WiFi charg√©s
lsmod | grep -E "(iwlwifi|b43|rtl|ath|mt7921)"

# V√©rifier les interfaces r√©seau
ip link show
iwconfig  # Commande d√©di√©e WiFi
```

#### Installation pilotes WiFi Broadcom

```bash
# Pour chipsets Broadcom (fr√©quents sur laptops)
# Identifier d'abord le chipset exact
lspci | grep -i broadcom

# Installation du pilote propri√©taire
sudo apt update
sudo apt install broadcom-sta-dkms

# Alternative : pilote libre (moins performant)
sudo apt install firmware-b43-installer

# Red√©marrer le module WiFi
sudo modprobe -r b43 bcma
sudo modprobe b43

# Ou red√©marrer compl√®tement
sudo reboot
```

#### Installation pilotes WiFi Intel

```bash
# Les cartes Intel utilisent g√©n√©ralement des pilotes libres
# mais n√©cessitent des firmwares propri√©taires

# Installation firmware Intel
sudo apt install firmware-iwlwifi

# Red√©marrer le module
sudo modprobe -r iwlwifi
sudo modprobe iwlwifi

# V√©rifier la d√©tection
iwconfig
```

#### Installation pilotes WiFi Realtek

```bash
# Pour chipsets Realtek (rtl8812au, rtl8821ce, etc.)
sudo apt install firmware-realtek

# Pour certains chipsets r√©cents, compilation n√©cessaire
# Exemple pour RTL8821CE :
sudo apt install git dkms build-essential
git clone https://github.com/tomaspinho/rtl8821ce
cd rtl8821ce
sudo ./dkms-install.sh

# Red√©marrer
sudo reboot
```

### üîß Gestion des pilotes via interface graphique

#### GNOME - Logiciels additionnels

1. **Ouvrir** : Param√®tres ‚Üí √Ä propos ‚Üí Logiciels additionnels
2. **S√©lectionner** : Pilotes propri√©taires disponibles
3. **Installer** : Cliquer sur "Installer"
4. **Red√©marrer** : Obligatoire apr√®s installation

#### Alternative : Gestionnaire de pilotes tiers

```bash
# Installation d'un gestionnaire graphique de pilotes
sudo apt install software-properties-common

# Interface graphique pour pilotes
software-properties-gtk
# Onglet "Pilotes additionnels"
```

---

## 2.3.2 Gestion de l'alimentation et suspend/hibernate

### üîã Comprendre la gestion d'alimentation

#### Modes d'alimentation disponibles

**Suspend (Veille)** :
- **Principe** : RAM aliment√©e, reste du syst√®me √©teint
- **Avantages** : R√©veil instantan√©, consommation tr√®s faible
- **Inconv√©nients** : Perte des donn√©es si batterie vide

**Hibernate (Hibernation)** :
- **Principe** : RAM sauvegard√©e sur disque, syst√®me compl√®tement √©teint
- **Avantages** : Pas de consommation, donn√©es pr√©serv√©es
- **Inconv√©nients** : R√©veil plus lent, n√©cessite espace disque = RAM

**Hybrid-sleep (Veille hybride)** :
- **Principe** : Combine suspend + hibernate
- **Avantages** : R√©veil rapide + s√©curit√© des donn√©es
- **Inconv√©nients** : Plus complexe √† configurer

### ‚ö° Configuration de base

#### V√©rifier les capacit√©s actuelles

```bash
# Voir les modes support√©s par votre mat√©riel
cat /sys/power/state
# R√©sultat typique : freeze mem disk

# Tester la suspension (attention : l'ordinateur va se mettre en veille !)
sudo systemctl suspend

# V√©rifier si l'hibernation est possible
sudo systemctl hibernate
# Peut √©chouer si pas configur√©e
```

#### Configuration TLP (optimisation batterie laptops)

```bash
# Installation TLP (ThinkPad-Linux-Project)
sudo apt update
sudo apt install tlp tlp-rdw

# D√©marrer TLP
sudo systemctl enable tlp
sudo systemctl start tlp

# V√©rifier le statut
sudo tlp-stat -s

# Configuration (optionnelle)
sudo nano /etc/tlp.conf
# Principales options :
# CPU_SCALING_GOVERNOR_ON_AC=performance
# CPU_SCALING_GOVERNOR_ON_BAT=powersave
# START_CHARGE_THRESH_BAT0=75
# STOP_CHARGE_THRESH_BAT0=80
```

#### Configuration Hibernation

```bash
# V√©rifier la taille du swap (doit √™tre >= taille RAM)
free -h
swapon --show

# Si pas assez de swap, cr√©er un fichier swap
sudo fallocate -l 8G /swapfile  # Adapter √† votre RAM
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile

# Rendre permanent
echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab

# Identifier l'UUID du swap
sudo blkid | grep swap

# Configurer GRUB pour hibernation
sudo nano /etc/default/grub
# Ajouter : GRUB_CMDLINE_LINUX_DEFAULT="resume=UUID=votre-uuid-swap"

# Mettre √† jour GRUB
sudo update-grub

# Tester l'hibernation
sudo systemctl hibernate
```

### üîß Configuration avanc√©e gestion d'alimentation

#### Param√®tres GNOME

**Via interface graphique** :
1. Param√®tres ‚Üí Alimentation
2. Configurer :
   - **Suspension automatique** : D√©lai souhait√©
   - **√âcran vide** : Temps avant extinction √©cran
   - **WiFi** : Garder actif en veille ou non
   - **Bluetooth** : Idem

#### Param√®tres en ligne de commande

```bash
# Voir les param√®tres actuels
gsettings get org.gnome.settings-daemon.plugins.power sleep-inactive-ac-timeout
gsettings get org.gnome.settings-daemon.plugins.power sleep-inactive-battery-timeout

# Configurer d√©lais de veille (en secondes)
# Secteur : 30 minutes (1800s)
gsettings set org.gnome.settings-daemon.plugins.power sleep-inactive-ac-timeout 1800

# Batterie : 15 minutes (900s)
gsettings set org.gnome.settings-daemon.plugins.power sleep-inactive-battery-timeout 900

# D√©sactiver la veille automatique
gsettings set org.gnome.settings-daemon.plugins.power sleep-inactive-ac-timeout 0
gsettings set org.gnome.settings-daemon.plugins.power sleep-inactive-battery-timeout 0
```

#### Optimisations sp√©cifiques laptops

```bash
# Script d'optimisation batterie
cat << 'EOF' > ~/optimiser-batterie.sh
#!/bin/bash
echo "=== OPTIMISATION BATTERIE ==="

# R√©duire la luminosit√© de l'√©cran
echo 50 | sudo tee /sys/class/backlight/*/brightness

# Activer le mode √©conomie d'√©nergie CPU
echo powersave | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

# D√©sactiver Bluetooth si inutilis√©
sudo systemctl stop bluetooth

# Optimiser les param√®tres disque
echo 1500 | sudo tee /proc/sys/vm/dirty_writeback_centisecs

# D√©sactiver WiFi power management si probl√©matique
sudo iwconfig wlan0 power off 2>/dev/null

echo "‚úÖ Optimisations appliqu√©es"
echo "Autonomie estim√©e am√©lior√©e de 10-20%"
EOF

chmod +x ~/optimiser-batterie.sh
```

---

## 2.3.3 Configuration multi-√©crans

### üñ•Ô∏è Comprendre les configurations multi-√©crans

#### Types de configurations courantes

**Configuration Extended (√âtendu)** :
- √âcrans c√¥te √† c√¥te
- Bureau agrandi sur plusieurs √©crans
- D√©placement souris fluide entre √©crans

**Configuration Mirror (Miroir)** :
- M√™me contenu sur tous les √©crans
- Id√©al pour pr√©sentations
- R√©solution limit√©e au plus petit √©cran

**Configuration Primary + Secondary** :
- Un √©cran principal (barres des t√¢ches, notifications)
- √âcrans secondaires pour applications sp√©cifiques

### üîß Configuration via interface graphique

#### GNOME Settings

1. **Ouvrir** : Param√®tres ‚Üí Affichage
2. **Interface** : Vue avec rectangles repr√©sentant les √©crans
3. **Configuration** :
   - **Glisser** les √©crans pour ajuster position
   - **Clic** sur √©cran pour le s√©lectionner
   - **R√©solution** : Choisir pour chaque √©cran
   - **Orientation** : Portrait/Paysage
   - **√âchelle** : 100%, 125%, 150%, 200%
   - **√âcran principal** : Cocher la case

#### KDE System Settings

1. **Ouvrir** : Param√®tres syst√®me ‚Üí Affichage et moniteur
2. **Configuration √©crans** :
   - Position relative des √©crans
   - R√©solution individuelle
   - Taux de rafra√Æchissement
   - Rotation

### üìê Configuration en ligne de commande

#### Utilisation de xrandr

```bash
# Voir la configuration actuelle
xrandr
# R√©sultat : Liste √©crans connect√©s et r√©solutions disponibles

# Exemple de sortie :
# Screen 0: minimum 8 x 8, current 3840 x 1080, maximum 32767 x 32767
# eDP-1 connected primary 1920x1080+0+0
# HDMI-1 connected 1920x1080+1920+0

# Configuration basique double √©cran
xrandr --output HDMI-1 --mode 1920x1080 --right-of eDP-1

# √âcran externe comme principal
xrandr --output HDMI-1 --primary

# Miroir (clone)
xrandr --output HDMI-1 --same-as eDP-1

# √âteindre un √©cran
xrandr --output HDMI-1 --off

# Rotation d'√©cran
xrandr --output eDP-1 --rotate left  # ou right, inverted, normal
```

#### Scripts de configuration automatique

```bash
# Script pour configuration bureau
cat << 'EOF' > ~/config-double-ecran.sh
#!/bin/bash
echo "Configuration double √©cran pour bureau"

# D√©tecter les √©crans connect√©s
INTERNAL=$(xrandr | grep "connected primary" | cut -d' ' -f1)
EXTERNAL=$(xrandr | grep "connected" | grep -v "primary" | head -1 | cut -d' ' -f1)

if [ -n "$EXTERNAL" ]; then
    echo "√âcran externe d√©tect√©: $EXTERNAL"

    # Configuration : externe √† droite de l'interne
    xrandr --output $EXTERNAL --mode 1920x1080 --right-of $INTERNAL

    # √âcran externe comme principal
    xrandr --output $EXTERNAL --primary

    echo "‚úÖ Configuration appliqu√©e"
else
    echo "Aucun √©cran externe d√©tect√©"
fi
EOF

chmod +x ~/config-double-ecran.sh

# Script pour pr√©sentations
cat << 'EOF' > ~/config-presentation.sh
#!/bin/bash
echo "Configuration pr√©sentation (miroir)"

INTERNAL=$(xrandr | grep "connected primary" | cut -d' ' -f1)
EXTERNAL=$(xrandr | grep "connected" | grep -v "primary" | head -1 | cut -d' ' -f1)

if [ -n "$EXTERNAL" ]; then
    # Mode miroir avec r√©solution compatible
    xrandr --output $EXTERNAL --same-as $INTERNAL --mode 1024x768
    echo "‚úÖ Mode pr√©sentation activ√©"
else
    echo "Connectez d'abord un √©cran externe"
fi
EOF

chmod +x ~/config-presentation.sh
```

### üéØ Configurations sp√©cifiques par cas d'usage

#### Configuration d√©veloppeur (3 √©crans)

```bash
# Exemple : Laptop + 2 √©crans externes
# √âcran 1 (gauche) : Code
# √âcran 2 (centre) : Principal/navigateur
# √âcran 3 (droite) : Terminal/monitoring

xrandr \
  --output eDP-1 --mode 1920x1080 --pos 0x0 \
  --output HDMI-1 --mode 1920x1080 --pos 1920x0 --primary \
  --output DP-1 --mode 1920x1080 --pos 3840x0
```

#### Configuration gaming

```bash
# Optimiser pour gaming : √©cran principal haute fr√©quence
xrandr --output HDMI-1 --mode 1920x1080 --rate 144 --primary
# √âcran secondaire pour chat/guides
xrandr --output eDP-1 --mode 1920x1080 --right-of HDMI-1
```

---

## 2.3.4 Bluetooth et p√©riph√©riques

### üì± Configuration Bluetooth

#### Installation et activation

```bash
# V√©rifier si Bluetooth est pr√©sent
lsusb | grep -i bluetooth
lspci | grep -i bluetooth

# Installation des outils Bluetooth
sudo apt update
sudo apt install bluetooth bluez bluez-tools

# D√©marrer et activer le service
sudo systemctl start bluetooth
sudo systemctl enable bluetooth

# V√©rifier le statut
sudo systemctl status bluetooth
```

#### Utilisation en ligne de commande

```bash
# Outil en ligne de commande Bluetooth
bluetoothctl

# Dans bluetoothctl :
# power on          # Activer Bluetooth
# scan on           # Scanner les p√©riph√©riques
# devices           # Lister p√©riph√©riques d√©tect√©s
# pair XX:XX:XX:XX  # Appairer avec adresse MAC
# connect XX:XX:XX  # Se connecter
# trust XX:XX:XX    # Faire confiance (reconnexion auto)
# exit              # Quitter

# Exemple complet de connexion casque
bluetoothctl << EOF
power on
agent on
scan on
EOF

# Attendre quelques secondes puis
echo "S√©lectionnez votre p√©riph√©rique dans la liste et notez son adresse MAC"
bluetoothctl devices
```

#### Interface graphique Bluetooth

**GNOME** :
1. Param√®tres ‚Üí Bluetooth
2. Activer le Bluetooth
3. P√©riph√©riques disponibles apparaissent automatiquement
4. Cliquer sur le p√©riph√©rique pour se connecter

**Gestionnaire Bluetooth graphique** :
```bash
# Installation interface graphique avanc√©e
sudo apt install blueman

# Lancer le gestionnaire
blueman-manager
```

### üéß Configuration p√©riph√©riques audio Bluetooth

#### Casques et √©couteurs

```bash
# Installer support audio Bluetooth
sudo apt install pulseaudio-module-bluetooth

# Red√©marrer PulseAudio
pulseaudio -k
pulseaudio --start

# Apr√®s connexion du casque, le configurer
pavucontrol
# Onglet "Configuration" : S√©lectionner profil audio
# Onglet "Lecture" : Diriger son vers casque Bluetooth
```

#### R√©solution probl√®mes audio Bluetooth

```bash
# Script de d√©bogage audio Bluetooth
cat << 'EOF' > ~/debug-bluetooth-audio.sh
#!/bin/bash
echo "=== DEBUG AUDIO BLUETOOTH ==="

echo "1. Statut Bluetooth:"
systemctl status bluetooth | grep Active

echo "2. P√©riph√©riques Bluetooth connect√©s:"
bluetoothctl devices | grep Device

echo "3. Modules PulseAudio Bluetooth:"
pactl list modules | grep bluetooth

echo "4. Cartes audio disponibles:"
pactl list cards short

echo "5. Sources audio actives:"
pactl list sources short

echo "6. Test de red√©marrage modules:"
sudo modprobe -r btusb
sudo modprobe btusb
pulseaudio -k
pulseaudio --start

echo "‚úÖ Red√©marrage modules termin√©"
EOF

chmod +x ~/debug-bluetooth-audio.sh
```

### ‚å®Ô∏è Claviers et souris

#### Configuration souris Bluetooth

```bash
# Apr√®s appairage, configurer la souris
# Sensibilit√©
xinput list  # Identifier l'ID de la souris
xinput set-prop [ID] "libinput Accel Speed" 0.5  # Ajuster vitesse

# Clic molette (si support√©)
xinput set-button-map [ID] 1 2 3 4 5 6 7 8 9
```

#### Configuration clavier Bluetooth

```bash
# Layout clavier fran√ßais
setxkbmap fr

# Rendre permanent
echo 'setxkbmap fr' >> ~/.bashrc

# Configuration avanc√©e clavier
# GNOME : Param√®tres ‚Üí Clavier ‚Üí Sources de saisie
# Ajouter "Fran√ßais (France)"
```

### üñ®Ô∏è Autres p√©riph√©riques

#### Imprimantes

```bash
# Support imprimantes r√©seau/Bluetooth
sudo apt install cups cups-browsed

# Interface web CUPS
firefox http://localhost:631

# Ajouter imprimante via interface
# Administration ‚Üí Add Printer ‚Üí S√©lectionner Bluetooth
```

#### Manettes de jeu

```bash
# Support manettes Bluetooth (PS4, Xbox, etc.)
sudo apt install joystick jstest-gtk

# Tester la manette apr√®s connexion
jstest /dev/input/js0

# Interface graphique test
jstest-gtk
```

### üîß Script de configuration Bluetooth complet

```bash
cat << 'EOF' > ~/setup-bluetooth-complet.sh
#!/bin/bash
echo "=== SETUP BLUETOOTH COMPLET ==="

# Installation paquets n√©cessaires
echo "1. Installation des paquets..."
sudo apt update
sudo apt install -y \
  bluetooth bluez bluez-tools \
  pulseaudio-module-bluetooth \
  blueman

# D√©marrage services
echo "2. D√©marrage des services..."
sudo systemctl enable bluetooth
sudo systemctl start bluetooth

# Configuration PulseAudio
echo "3. Configuration audio..."
pulseaudio -k
pulseaudio --start

# Test mat√©riel
echo "4. Test mat√©riel Bluetooth..."
if lsusb | grep -i bluetooth >/dev/null; then
    echo "‚úÖ Adaptateur Bluetooth d√©tect√©"
else
    echo "‚ùå Aucun adaptateur Bluetooth trouv√©"
    exit 1
fi

# Test service
if systemctl is-active bluetooth >/dev/null; then
    echo "‚úÖ Service Bluetooth actif"
else
    echo "‚ùå Service Bluetooth inactif"
    exit 1
fi

# Configuration automatique
echo "5. Configuration automatique..."
bluetoothctl << 'BT_EOF'
power on
agent on
default-agent
discoverable on
BT_EOF

echo ""
echo "‚úÖ Configuration Bluetooth termin√©e"
echo ""
echo "Pour connecter un p√©riph√©rique:"
echo "1. Mettre le p√©riph√©rique en mode appairage"
echo "2. Ouvrir Param√®tres ‚Üí Bluetooth (GNOME)"
echo "3. Ou utiliser : blueman-manager"
echo "4. Ou en ligne de commande : bluetoothctl"

# Guide rapide
cat << 'GUIDE' > ~/guide-bluetooth.txt
=== GUIDE RAPIDE BLUETOOTH ===

COMMANDES BLUETOOTHCTL ESSENTIELLES:
- bluetoothctl          # Ouvrir l'interface
- power on              # Activer Bluetooth
- scan on               # Scanner p√©riph√©riques
- devices               # Lister p√©riph√©riques
- pair XX:XX:XX:XX:XX   # Appairer
- connect XX:XX:XX:XX   # Connecter
- trust XX:XX:XX:XX     # Faire confiance
- remove XX:XX:XX:XX    # Supprimer

PROBL√àMES COURANTS:
- Casque pas d'audio ‚Üí V√©rifier pavucontrol
- Reconnexion √©choue ‚Üí Red√©marrer bluetooth
- P√©riph√©rique invisible ‚Üí scan on + mode appairage
GUIDE

echo "üìã Guide cr√©√© : ~/guide-bluetooth.txt"
EOF

chmod +x ~/setup-bluetooth-complet.sh
./setup-bluetooth-complet.sh
```

---

## ‚úÖ Checklist finale de validation

### üîß Configuration mat√©rielle

- [ ] **Audit mat√©riel** : Rapport complet g√©n√©r√© et analys√©
- [ ] **Pilotes graphiques** : Install√©s et fonctionnels (NVIDIA/AMD/Intel)
- [ ] **Pilotes r√©seau** : WiFi et Ethernet op√©rationnels
- [ ] **Firmware** : Tous les firmwares propri√©taires install√©s si n√©cessaires
- [ ] **Tests 3D** : glxgears et performances graphiques valid√©es
- [ ] **Acc√©l√©ration mat√©rielle** : VA-API/VDPAU configur√©es

### üîã Gestion d'alimentation

- [ ] **TLP install√©** : Configuration optimis√©e pour laptops
- [ ] **Suspend/Resume** : Veille fonctionnelle et fiable
- [ ] **Hibernation** : Configur√©e et test√©e (si swap suffisant)
- [ ] **Optimisations batterie** : Scripts d'√©conomie d'√©nergie cr√©√©s
- [ ] **Seuils batterie** : Configuration ThinkPad si applicable
- [ ] **Capteurs** : Monitoring temp√©rature et ventilateurs

### üñ•Ô∏è Affichage et multi-√©crans

- [ ] **D√©tection automatique** : √âcrans externes reconnus
- [ ] **Scripts configuration** : Tous les modes test√©s (unique, dual, pr√©sentation)
- [ ] **R√©solutions optimales** : Chaque √©cran √† sa r√©solution native
- [ ] **Positionnement** : √âcrans arrang√©s logiquement
- [ ] **Applications multi-√©crans** : Comportement correct
- [ ] **Raccourcis √©crans** : Scripts rapides fonctionnels

### üì± P√©riph√©riques

- [ ] **Bluetooth actif** : Service d√©marr√© et fonctionnel
- [ ] **Appairage test√©** : Au moins un p√©riph√©rique connect√© avec succ√®s
- [ ] **Audio Bluetooth** : Casques/√©couteurs fonctionnels
- [ ] **USB** : Tous les ports test√©s avec diff√©rents p√©riph√©riques
- [ ] **Audio analogique** : Sortie et entr√©e micro test√©es
- [ ] **Webcam** : D√©tect√©e et fonctionnelle (Cheese/applications)

### üîç Monitoring et maintenance

- [ ] **Scripts diagnostic** : Tous cr√©√©s et test√©s
- [ ] **Surveillance automatique** : Configur√©e avec seuils appropri√©s
- [ ] **Guide maintenance** : Personnalis√© selon configuration
- [ ] **Sauvegarde configs** : Proc√©dures de backup mat√©riel
- [ ] **Score validation** : ‚â• 70/100 sur tests automatiques
- [ ] **Documentation** : Configuration actuelle document√©e

---

## üö® Troubleshooting final

### Probl√®me : Pilotes ne fonctionnent pas apr√®s red√©marrage

**Diagnostic** :
```bash
# V√©rifier modules charg√©s
lsmod | grep -E "(nvidia|nouveau|iwlwifi|rtl)"

# Voir erreurs de d√©marrage
dmesg | grep -E "(error|failed|nvidia|wifi)"

# V√©rifier blacklists
cat /etc/modprobe.d/blacklist*
```

**Solutions** :
```bash
# Recompiler modules DKMS
sudo dkms autoinstall

# R√©installer pilotes
sudo apt install --reinstall nvidia-driver

# Reconfigurer initramfs
sudo update-initramfs -u
```

### Probl√®me : Gestion d'alimentation ne fonctionne pas

**Diagnostic** :
```bash
# V√©rifier TLP
sudo tlp-stat -s

# Voir modes support√©s
cat /sys/power/state

# Logs de suspension
journalctl | grep -E "(suspend|hibernate|sleep)"
```

**Solutions** :
```bash
# Reconfigurer TLP
sudo systemctl restart tlp

# R√©parer hibernation
sudo update-grub
sudo update-initramfs -u

# Test manuel
sudo systemctl suspend
```

### Probl√®me : Multi-√©crans instable

**Diagnostic** :
```bash
# Configuration actuelle
xrandr

# Logs X11
grep -E "(HDMI|DP|VGA)" /var/log/Xorg.0.log
```

**Solutions** :
```bash
# Reset configuration
xrandr --auto

# Utiliser scripts fiables
~/ecran-unique.sh
~/ecran-double-etendu.sh

# Sauvegarder config working
xrandr > ~/config-ecrans-working.txt
```

---

## üìä Rapport de performance mat√©riel

### G√©n√©ration du rapport final

```bash
cat << 'EOF' > ~/rapport-final-materiel.sh
#!/bin/bash
RAPPORT="rapport-final-materiel-$(date +%Y%m%d).txt"

echo "=== RAPPORT FINAL CONFIGURATION MAT√âRIEL ===" > $RAPPORT
echo "G√©n√©r√© le: $(date)" >> $RAPPORT
echo "Utilisateur: $(whoami)" >> $RAPPORT
echo "Syst√®me: $(lsb_release -d | cut -f2)" >> $RAPPORT
echo "" >> $RAPPORT

# Configuration mat√©rielle finale
echo "=== CONFIGURATION MAT√âRIELLE FINALE ===" >> $RAPPORT
echo "Carte graphique:" >> $RAPPORT
lspci | grep -i vga >> $RAPPORT
echo "Pilote graphique actif:" >> $RAPPORT
lsmod | grep -E "(nvidia|nouveau|radeon|amdgpu|i915)" >> $RAPPORT
echo "" >> $RAPPORT

echo "R√©seau:" >> $RAPPORT
lspci | grep -E "(ethernet|wireless)" >> $RAPPORT
echo "Interfaces actives:" >> $RAPPORT
ip link show | grep "state UP" >> $RAPPORT
echo "" >> $RAPPORT

echo "Audio:" >> $RAPPORT
lspci | grep -i audio >> $RAPPORT
pactl list sinks short >> $RAPPORT
echo "" >> $RAPPORT

# Scripts cr√©√©s
echo "=== SCRIPTS ET OUTILS CR√â√âS ===" >> $RAPPORT
echo "Scripts de diagnostic:" >> $RAPPORT
ls ~/audit-*.sh ~/diagnostic-*.sh ~/validation-*.sh 2>/dev/null | sed 's|.*/||' | sort >> $RAPPORT
echo "" >> $RAPPORT
echo "Scripts de configuration:" >> $RAPPORT
ls ~/configurer-*.sh ~/installer-*.sh ~/setup-*.sh 2>/dev/null | sed 's|.*/||' | sort >> $RAPPORT
echo "" >> $RAPPORT
echo "Scripts utilitaires:" >> $RAPPORT
ls ~/ecran-*.sh ~/test-*.sh ~/surveillance-*.sh 2>/dev/null | sed 's|.*/||' | sort >> $RAPPORT
echo "" >> $RAPPORT

# Score final
if [ -f ~/validation-materiel-*.txt ]; then
    DERNIER_VALIDATION=$(ls ~/validation-materiel-*.txt | tail -1)
    echo "=== SCORE DE VALIDATION FINAL ===" >> $RAPPORT
    grep -A 5 "SCORE FINAL" "$DERNIER_VALIDATION" >> $RAPPORT
    echo "" >> $RAPPORT
fi

# Recommandations finales
echo "=== RECOMMANDATIONS FINALES ===" >> $RAPPORT
echo "1. Ex√©cuter validation hebdomadaire: ~/validation-materiel-complete.sh" >> $RAPPORT
echo "2. Surveiller temp√©ratures avec: sensors" >> $RAPPORT
echo "3. Maintenir pilotes √† jour: sudo apt update && sudo apt upgrade" >> $RAPPORT
echo "4. Consulter guide: ~/guide-maintenance-materiel.md" >> $RAPPORT
echo "5. Surveillance auto: ~/setup-surveillance-auto.sh" >> $RAPPORT
echo "" >> $RAPPORT

echo "Rapport sauvegard√©: $RAPPORT"
cat $RAPPORT
EOF

chmod +x ~/rapport-final-materiel.sh
./rapport-final-materiel.sh
```

---

## üéâ F√©licitations !

### Ce que vous avez accompli

üéØ **Configuration mat√©rielle optimale** : Tous pilotes install√©s et fonctionnels
üîã **Gestion d'alimentation avanc√©e** : TLP, veille, hibernation configur√©s
üñ•Ô∏è **Multi-√©crans ma√Ætris√©** : Scripts pour toutes configurations d'usage
üì± **P√©riph√©riques int√©gr√©s** : Bluetooth, USB, audio parfaitement fonctionnels
üîç **Monitoring automatis√©** : Surveillance continue de la sant√© mat√©rielle
üìö **Documentation compl√®te** : Guide de maintenance personnalis√©

### Comp√©tences d√©velopp√©es

‚úÖ **Diagnostic mat√©riel** : Identification et r√©solution probl√®mes hardware
‚úÖ **Gestion pilotes** : Installation, configuration, optimisation drivers
‚úÖ **Scripting syst√®me** : Automatisation des t√¢ches de configuration
‚úÖ **Monitoring avanc√©** : Surveillance proactive de la sant√© syst√®me
‚úÖ **Troubleshooting expert** : R√©solution autonome des probl√®mes complexes
‚úÖ **Optimisation performance** : Tuning mat√©riel selon profil d'usage

### Environnement mat√©riel cr√©√©

Votre syst√®me Debian dispose maintenant de :
- **Pilotes optimaux** pour toutes les cartes (graphique, r√©seau, audio)
- **Gestion intelligente** de l'alimentation et des performances
- **Configurations √©crans** adaptables √† tous les contextes
- **Support complet** de tous vos p√©riph√©riques
- **Monitoring automatique** avec alertes pr√©ventives
- **Outils de maintenance** pour p√©rennit√© long terme

### Prochaines √©tapes

Votre configuration mat√©rielle est maintenant optimale et enti√®rement automatis√©e. La section suivante vous permettra de personnaliser et optimiser l'interface utilisateur pour une productivit√© maximale.

**üéØ Pr√™t pour la section 2.4 : Personnalisation et optimisation !**

---

*üí° **Conseil final** : La configuration mat√©rielle que vous venez de cr√©er est robuste et √©volutive. Gardez vos scripts de diagnostic et configuration √† jour. En cas de changement de mat√©riel ou de mise √† jour syst√®me, relancez vos scripts de validation pour vous assurer que tout fonctionne toujours parfaitement. Le monitoring automatique vous alertera de tout probl√®me potentiel avant qu'il ne devienne critique.*


‚è≠Ô∏è
