üîù Retour au [Sommaire](/SOMMAIRE.md)

# Module 6.2 : Serveur web (Apache/Nginx)

*Tutoriel accessible aux d√©butants - Niveau : Interm√©diaire-Avanc√©*

## Introduction

Un serveur web est le c≈ìur de toute infrastructure Internet moderne. Il permet de servir des sites web, des APIs, et des applications web aux utilisateurs du monde entier. Dans ce chapitre, nous allons explorer les deux serveurs web les plus populaires : **Apache** et **Nginx**.

### Pourquoi Apache vs Nginx ?

**Apache HTTP Server** :
- ‚úÖ Plus ancien et tr√®s stable
- ‚úÖ √ânorme communaut√© et documentation
- ‚úÖ Modules tr√®s nombreux
- ‚úÖ Configuration flexible via .htaccess
- ‚ùå Plus lourd en ressources

**Nginx** :
- ‚úÖ Tr√®s performant et l√©ger
- ‚úÖ Excellent pour le reverse proxy
- ‚úÖ Gestion native des connexions multiples
- ‚úÖ Id√©al pour servir du contenu statique
- ‚ùå Configuration centralis√©e uniquement

> **üí° Conseil d√©butant** : Nous commencerons par Apache (plus facile) puis aborderons Nginx.

---

## 6.2.1 Installation et configuration

### Installation d'Apache

#### Installation des paquets

```bash
# Mise √† jour du syst√®me
apt update

# Installation d'Apache et modules essentiels
apt install -y apache2 apache2-utils

# V√©rifier l'installation
apache2 -v
systemctl status apache2
```

**R√©sultat attendu** :
```
Server version: Apache/2.4.57 (Debian)
Server built:   2023-04-13T03:26:51

‚óè apache2.service - The Apache HTTP Server
     Loaded: loaded (/lib/systemd/system/apache2.service; enabled; vendor preset: enabled)
     Active: active (running)
```

#### Structure des r√©pertoires Apache

**Comprenons l'organisation d'Apache sur Debian** :

```bash
# R√©pertoires principaux
ls -la /etc/apache2/
```

```
/etc/apache2/
‚îú‚îÄ‚îÄ apache2.conf          # Configuration principale
‚îú‚îÄ‚îÄ ports.conf            # Configuration des ports
‚îú‚îÄ‚îÄ sites-available/      # Sites disponibles
‚îú‚îÄ‚îÄ sites-enabled/        # Sites activ√©s (liens symboliques)
‚îú‚îÄ‚îÄ mods-available/       # Modules disponibles
‚îú‚îÄ‚îÄ mods-enabled/         # modules activ√©s
‚îú‚îÄ‚îÄ conf-available/       # Configurations disponibles
‚îî‚îÄ‚îÄ conf-enabled/         # Configurations activ√©es
```

**R√©pertoires de donn√©es** :
```
/var/www/html/           # R√©pertoire web par d√©faut
/var/log/apache2/        # Logs d'Apache
```

#### Configuration de base d'Apache

**√âditer la configuration principale** :
```bash
# Sauvegarder la configuration originale
cp /etc/apache2/apache2.conf /etc/apache2/apache2.conf.backup

# √âditer la configuration
nano /etc/apache2/apache2.conf
```

**Optimisations recommand√©es pour d√©butants** :
```apache
# Cacher la version d'Apache (s√©curit√©)
ServerTokens Prod
ServerSignature Off

# Timeout des connexions
Timeout 60
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5

# S√©curit√© - Emp√™cher l'acc√®s aux fichiers syst√®me
<FilesMatch "^\.ht">
    Require all denied
</FilesMatch>

# D√©sactiver l'indexation des r√©pertoires par d√©faut
Options -Indexes
```

#### Premier test du serveur

```bash
# D√©marrer Apache si ce n'est pas fait
systemctl start apache2

# L'activer au d√©marrage
systemctl enable apache2

# V√©rifier que le port 80 est ouvert
ss -tulpn | grep :80

# Tester depuis le serveur
curl -I http://localhost
```

**Depuis votre navigateur** : `http://192.168.1.100`

Vous devriez voir la page par d√©faut d'Apache.

### Installation et configuration de Nginx

#### Installation de Nginx

```bash
# Installation
apt install -y nginx

# D√©marrer et activer Nginx
systemctl start nginx
systemctl enable nginx

# V√©rifier l'installation
nginx -v
systemctl status nginx
```

#### Structure des r√©pertoires Nginx

```bash
ls -la /etc/nginx/
```

```
/etc/nginx/
‚îú‚îÄ‚îÄ nginx.conf              # Configuration principale
‚îú‚îÄ‚îÄ sites-available/        # Sites disponibles
‚îú‚îÄ‚îÄ sites-enabled/          # Sites activ√©s
‚îú‚îÄ‚îÄ conf.d/                 # Configurations suppl√©mentaires
‚îú‚îÄ‚îÄ modules-available/      # Modules disponibles
‚îî‚îÄ‚îÄ modules-enabled/        # Modules activ√©s
```

#### Configuration de base de Nginx

```bash
# Sauvegarder la configuration
cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup

# √âditer la configuration principale
nano /etc/nginx/nginx.conf
```

**Configuration optimis√©e pour d√©butants** :
```nginx
user www-data;
worker_processes auto;
pid /run/nginx.pid;

events {
    worker_connections 1024;
    use epoll;
    multi_accept on;
}

http {
    # Types MIME
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    # Logs
    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';

    access_log /var/log/nginx/access.log main;
    error_log /var/log/nginx/error.log;

    # Performance
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;

    # S√©curit√©
    server_tokens off;
    add_header X-Content-Type-Options nosniff;
    add_header X-Frame-Options DENY;
    add_header X-XSS-Protection "1; mode=block";

    # Gzip compression
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

    # Sites virtuels
    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/sites-enabled/*;
}
```

### Configuration du pare-feu pour serveurs web

```bash
# Autoriser HTTP et HTTPS si ce n'est pas d√©j√† fait
ufw allow 80/tcp
ufw allow 443/tcp

# V√©rifier les r√®gles
ufw status numbered
```

---

## 6.2.2 Virtual hosts et reverse proxy

### Comprendre les Virtual Hosts

Les **Virtual Hosts** permettent d'h√©berger plusieurs sites web sur un seul serveur. Chaque site a sa propre configuration, ses propres fichiers, et peut avoir son propre nom de domaine.

**Avantages** :
- √âconomie de ressources (un seul serveur pour plusieurs sites)
- Isolation des sites
- Configuration sp√©cifique par site

### Virtual Hosts avec Apache

#### Cr√©er la structure des r√©pertoires

```bash
# Cr√©er les r√©pertoires pour deux sites d'exemple
mkdir -p /var/www/site1.exemple.com/html
mkdir -p /var/www/site2.exemple.com/html
mkdir -p /var/www/site1.exemple.com/logs
mkdir -p /var/www/site2.exemple.com/logs

# D√©finir les permissions appropri√©es
chown -R www-data:www-data /var/www/site1.exemple.com
chown -R www-data:www-data /var/www/site2.exemple.com
chmod -R 755 /var/www/site1.exemple.com
chmod -R 755 /var/www/site2.exemple.com
```

#### Cr√©er du contenu de test

```bash
# Page d'accueil pour site1
cat > /var/www/site1.exemple.com/html/index.html << EOF
<!DOCTYPE html>
<html>
<head>
    <title>Site 1 - Mon Premier Site</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f0f8ff; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; background: white; border-radius: 10px; }
        h1 { color: #2c3e50; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bienvenue sur le Site 1</h1>
        <p>Ceci est mon premier site web h√©berg√© sur Apache!</p>
        <p>Serveur: $(hostname)</p>
        <p>Date: $(date)</p>
    </div>
</body>
</html>
EOF

# Page d'accueil pour site2
cat > /var/www/site2.exemple.com/html/index.html << EOF
<!DOCTYPE html>
<html>
<head>
    <title>Site 2 - Mon Second Site</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #fff8f0; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; background: white; border-radius: 10px; }
        h1 { color: #e74c3c; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bienvenue sur le Site 2</h1>
        <p>Ceci est mon second site web!</p>
        <p>Configuration Apache Virtual Host</p>
    </div>
</body>
</html>
EOF
```

#### Configuration des Virtual Hosts Apache

**Cr√©er le fichier de configuration pour le site 1** :
```bash
nano /etc/apache2/sites-available/site1.exemple.com.conf
```

```apache
<VirtualHost *:80>
    # Informations du site
    ServerName site1.exemple.com
    ServerAlias www.site1.exemple.com
    ServerAdmin admin@site1.exemple.com

    # R√©pertoires
    DocumentRoot /var/www/site1.exemple.com/html

    # Logs sp√©cifiques √† ce site
    ErrorLog /var/www/site1.exemple.com/logs/error.log
    CustomLog /var/www/site1.exemple.com/logs/access.log combined

    # Configuration du r√©pertoire
    <Directory /var/www/site1.exemple.com/html>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # S√©curit√© - emp√™cher l'acc√®s aux fichiers sensibles
    <Files ~ "\.(htaccess|htpasswd|ini|log|sh|inc|bak)$">
        Require all denied
    </Files>
</VirtualHost>
```

**Cr√©er le fichier de configuration pour le site 2** :
```bash
nano /etc/apache2/sites-available/site2.exemple.com.conf
```

```apache
<VirtualHost *:80>
    ServerName site2.exemple.com
    ServerAlias www.site2.exemple.com
    ServerAdmin admin@site2.exemple.com

    DocumentRoot /var/www/site2.exemple.com/html

    ErrorLog /var/www/site2.exemple.com/logs/error.log
    CustomLog /var/www/site2.exemple.com/logs/access.log combined

    <Directory /var/www/site2.exemple.com/html>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```

#### Activation des sites

```bash
# D√©sactiver le site par d√©faut
a2dissite 000-default

# Activer nos nouveaux sites
a2ensite site1.exemple.com
a2ensite site2.exemple.com

# V√©rifier la configuration
apache2ctl configtest

# Recharger Apache
systemctl reload apache2

# V√©rifier les sites activ√©s
apache2ctl -S
```

### Virtual Hosts avec Nginx

#### Cr√©er les configurations Nginx

**Configuration pour site1** :
```bash
nano /etc/nginx/sites-available/site1.exemple.com
```

```nginx
server {
    listen 80;
    listen [::]:80;

    server_name site1.exemple.com www.site1.exemple.com;
    root /var/www/site1.exemple.com/html;
    index index.html index.htm;

    # Logs
    access_log /var/www/site1.exemple.com/logs/access.log;
    error_log /var/www/site1.exemple.com/logs/error.log;

    # Configuration principale
    location / {
        try_files $uri $uri/ =404;
    }

    # S√©curit√© - bloquer l'acc√®s aux fichiers sensibles
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }

    location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

**Configuration pour site2** :
```bash
nano /etc/nginx/sites-available/site2.exemple.com
```

```nginx
server {
    listen 80;
    listen [::]:80;

    server_name site2.exemple.com www.site2.exemple.com;
    root /var/www/site2.exemple.com/html;
    index index.html index.htm;

    access_log /var/www/site2.exemple.com/logs/access.log;
    error_log /var/www/site2.exemple.com/logs/error.log;

    location / {
        try_files $uri $uri/ =404;
    }

    location ~ /\. {
        deny all;
    }
}
```

#### Activation des sites Nginx

```bash
# D√©sactiver le site par d√©faut
unlink /etc/nginx/sites-enabled/default

# Activer nos sites
ln -s /etc/nginx/sites-available/site1.exemple.com /etc/nginx/sites-enabled/
ln -s /etc/nginx/sites-available/site2.exemple.com /etc/nginx/sites-enabled/

# Tester la configuration
nginx -t

# Recharger Nginx
systemctl reload nginx
```

### Configuration du Reverse Proxy avec Nginx

Un **reverse proxy** agit comme interm√©diaire entre les clients et les serveurs backend. C'est tr√®s utile pour :
- √âquilibrage de charge
- Cache
- SSL/TLS termination
- S√©curit√© additionnelle

#### Exemple : Nginx reverse proxy vers Apache

**Sc√©nario** : Nginx sur le port 80 qui redirige vers Apache sur le port 8080.

**1. Configurer Apache sur le port 8080** :
```bash
# Modifier le port d'Apache
nano /etc/apache2/ports.conf
```

```apache
Listen 8080
```

**Modifier le Virtual Host** :
```bash
nano /etc/apache2/sites-available/site1.exemple.com.conf
```

```apache
<VirtualHost *:8080>
    # ... reste de la configuration identique
</VirtualHost>
```

```bash
# Recharger Apache
systemctl reload apache2
```

**2. Configurer Nginx comme reverse proxy** :
```bash
nano /etc/nginx/sites-available/proxy.exemple.com
```

```nginx
server {
    listen 80;
    server_name proxy.exemple.com;

    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # Timeouts
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}
```

```bash
# Activer le proxy
ln -s /etc/nginx/sites-available/proxy.exemple.com /etc/nginx/sites-enabled/
nginx -t
systemctl reload nginx
```

### Test des Virtual Hosts

**Pour tester sans DNS**, modifier le fichier hosts de votre PC :

**Sous Linux/Mac** : `/etc/hosts`
**Sous Windows** : `C:\Windows\System32\drivers\etc\hosts`

Ajouter :
```
192.168.1.100 site1.exemple.com
192.168.1.100 site2.exemple.com
192.168.1.100 proxy.exemple.com
```

**Tester depuis le navigateur** :
- `http://site1.exemple.com`
- `http://site2.exemple.com`
- `http://proxy.exemple.com`

---

## 6.2.3 Modules et extensions

### Modules Apache essentiels

#### Modules de base recommand√©s

```bash
# Voir les modules activ√©s
apache2ctl -M

# Activer des modules utiles
a2enmod rewrite      # R√©√©criture d'URLs
a2enmod ssl          # Support SSL/TLS
a2enmod headers      # Manipulation des en-t√™tes HTTP
a2enmod deflate      # Compression gzip
a2enmod expires      # Contr√¥le du cache navigateur
a2enmod security2    # ModSecurity (WAF)

# Recharger Apache apr√®s activation des modules
systemctl reload apache2
```

#### Module de r√©√©criture (mod_rewrite)

**Exemple d'utilisation dans .htaccess** :
```bash
nano /var/www/site1.exemple.com/html/.htaccess
```

```apache
# Activer le moteur de r√©√©criture
RewriteEngine On

# Redirection HTTP vers HTTPS (√† utiliser plus tard)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# URLs conviviales - exemple
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^page/([^/]+)/?$ page.php?name=$1 [L,QSA]

# Bloquer l'acc√®s aux fichiers de backup
RewriteRule \.(bak|backup|swp|old)$ - [F,L]

# Cache des fichiers statiques
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
</IfModule>
```

#### Module de compression (mod_deflate)

**Configuration dans le Virtual Host** :
```apache
<VirtualHost *:80>
    # ... configuration existante

    # Compression gzip
    <IfModule mod_deflate.c>
        AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json

        # Exclure certains navigateurs anciens
        BrowserMatch ^Mozilla/4 gzip-only-text/html
        BrowserMatch ^Mozilla/4\.0[678] no-gzip
        BrowserMatch \bMSIE !no-gzip !gzip-only-text/html

        # Ne pas compresser les images (d√©j√† compress√©es)
        SetEnvIfNoCase Request_URI \
            \.(?:gif|jpe?g|png)$ no-gzip dont-vary
    </IfModule>
</VirtualHost>
```

### Modules Nginx

#### Modules compil√©s par d√©faut

```bash
# Voir les modules compil√©s
nginx -V 2>&1 | grep -o with-[a-z_]*

# Modules utiles g√©n√©ralement disponibles :
# --with-http_ssl_module        (SSL/TLS)
# --with-http_gzip_module       (Compression)
# --with-http_realip_module     (IP r√©elles derri√®re proxy)
# --with-http_stub_status_module (Statistiques)
```

#### Configuration du module status

**Pour surveiller Nginx** :
```bash
nano /etc/nginx/sites-available/status
```

```nginx
server {
    listen 127.0.0.1:8080;
    server_name localhost;

    location /nginx_status {
        stub_status on;
        access_log off;
        allow 127.0.0.1;
        deny all;
    }

    location /server-status {
        return 200 "Nginx server status OK\n";
        add_header Content-Type text/plain;
    }
}
```

```bash
# Activer le module status
ln -s /etc/nginx/sites-available/status /etc/nginx/sites-enabled/
systemctl reload nginx

# Tester
curl http://127.0.0.1:8080/nginx_status
```

### Extensions PHP (si n√©cessaire)

#### Installation de PHP avec Apache

```bash
# Installer PHP et modules essentiels
apt install -y php libapache2-mod-php php-mysql php-curl php-json php-mbstring php-xml

# Activer le module PHP dans Apache
a2enmod php8.2

# Red√©marrer Apache
systemctl restart apache2
```

#### Test de PHP

```bash
# Cr√©er un fichier de test PHP
nano /var/www/site1.exemple.com/html/info.php
```

```php
<?php
// Informations PHP
phpinfo();

// Test de connexion base de donn√©es (√† adapter)
echo "<h2>Test de configuration</h2>";
echo "PHP Version: " . phpversion() . "<br>";
echo "Server: " . $_SERVER['SERVER_SOFTWARE'] . "<br>";
echo "Document Root: " . $_SERVER['DOCUMENT_ROOT'] . "<br>";
?>
```

**Tester** : `http://site1.exemple.com/info.php`

> **‚ö†Ô∏è S√©curit√©** : Supprimer ce fichier apr√®s test !

#### Installation de PHP avec Nginx (PHP-FPM)

```bash
# Installer PHP-FPM
apt install -y php-fpm php-mysql php-curl php-json php-mbstring php-xml

# D√©marrer PHP-FPM
systemctl start php8.2-fpm
systemctl enable php8.2-fpm
```

**Configuration Nginx pour PHP** :
```bash
nano /etc/nginx/sites-available/site1.exemple.com
```

```nginx
server {
    # ... configuration existante

    # Support PHP
    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/var/run/php/php8.2-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
}
```

---

## 6.2.4 SSL/TLS et certificats (Let's Encrypt)

### Comprendre SSL/TLS

**SSL/TLS** (Secure Socket Layer / Transport Layer Security) chiffre les communications entre le navigateur et le serveur web. C'est devenu **obligatoire** pour :
- S√©curit√© des donn√©es
- Confiance des utilisateurs
- SEO (Google favorise HTTPS)
- Conformit√© RGPD

### Installation de Certbot (Let's Encrypt)

**Let's Encrypt** fournit des certificats SSL gratuits et automatis√©s.

```bash
# Installer certbot
apt install -y certbot

# Pour Apache
apt install -y python3-certbot-apache

# Pour Nginx
apt install -y python3-certbot-nginx
```

### Configuration SSL avec Apache

#### G√©n√©ration automatique du certificat

```bash
# G√©n√©rer et installer le certificat pour site1
certbot --apache -d site1.exemple.com -d www.site1.exemple.com

# Pendant l'installation, certbot va :
# 1. V√©rifier que vous contr√¥lez le domaine
# 2. G√©n√©rer le certificat
# 3. Modifier automatiquement la configuration Apache
# 4. Cr√©er une redirection HTTP vers HTTPS
```

**Options lors de l'installation** :
- Email pour les notifications : votre-email@exemple.com
- Accepter les conditions d'utilisation : Yes
- Partager l'email avec EFF : √† votre choix
- Redirection HTTP vers HTTPS : Recommand√© (2)

#### V√©rification de la configuration SSL

```bash
# V√©rifier les certificats install√©s
certbot certificates

# Voir la configuration g√©n√©r√©e
cat /etc/apache2/sites-available/site1.exemple.com-le-ssl.conf
```

**Configuration SSL g√©n√©r√©e par Certbot** :
```apache
<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName site1.exemple.com
    ServerAlias www.site1.exemple.com
    DocumentRoot /var/www/site1.exemple.com/html

    # Certificats Let's Encrypt
    SSLCertificateFile /etc/letsencrypt/live/site1.exemple.com/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/site1.exemple.com/privkey.pem
    Include /etc/letsencrypt/options-ssl-apache.conf

    # Configuration SSL s√©curis√©e
    SSLEngine on
    SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1
    SSLCipherSuite ECDHE+AESGCM:ECDHE+AES256:ECDHE+AES128:!aNULL:!MD5:!DSS
    SSLHonorCipherOrder on

    # Headers de s√©curit√©
    Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
</VirtualHost>
</IfModule>
```

### Configuration SSL avec Nginx

#### G√©n√©ration du certificat pour Nginx

```bash
# G√©n√©rer le certificat pour site1
certbot --nginx -d site1.exemple.com -d www.site1.exemple.com
```

**Configuration SSL Nginx g√©n√©r√©e** :
```nginx
server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;

    server_name site1.exemple.com www.site1.exemple.com;
    root /var/www/site1.exemple.com/html;

    # Certificats SSL
    ssl_certificate /etc/letsencrypt/live/site1.exemple.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/site1.exemple.com/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    # Headers de s√©curit√©
    add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;
    add_header X-Content-Type-Options nosniff always;
    add_header X-Frame-Options DENY always;
    add_header X-XSS-Protection "1; mode=block" always;

    location / {
        try_files $uri $uri/ =404;
    }
}

# Redirection HTTP vers HTTPS
server {
    listen 80;
    listen [::]:80;
    server_name site1.exemple.com www.site1.exemple.com;
    return 301 https://$server_name$request_uri;
}
```

### Renouvellement automatique des certificats

Let's Encrypt g√©n√®re des certificats valables 90 jours. Le renouvellement doit √™tre automatique.

#### Configuration du renouvellement automatique

```bash
# Tester le renouvellement
certbot renew --dry-run

# Le renouvellement automatique est configur√© par d√©faut via systemd
systemctl list-timers | grep certbot

# Voir le service de renouvellement
cat /etc/systemd/system/certbot.timer
```

**Configuration manuelle si n√©cessaire** :
```bash
# √âditer la crontab
crontab -e

# Ajouter cette ligne pour un renouvellement quotidien √† 3h
0 3 * * * certbot renew --quiet --post-hook "systemctl reload apache2"

# Pour Nginx
0 3 * * * certbot renew --quiet --post-hook "systemctl reload nginx"
```

### Test et validation SSL

#### Tester la configuration SSL

```bash
# Test depuis le serveur
curl -I https://site1.exemple.com

# V√©rifier les d√©tails du certificat
openssl s_client -connect site1.exemple.com:443 -servername site1.exemple.com
```

**Outils en ligne pour tester** :
- SSL Labs : https://www.ssllabs.com/ssltest/
- SSL Checker : https://www.sslchecker.com/

#### Score de s√©curit√© SSL optimal

Pour obtenir un score A+ sur SSL Labs :

**Configuration Apache additionnelle** :
```apache
# Dans le Virtual Host SSL
Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"

# Configuration SSL avanc√©e
SSLUseStapling On
SSLStaplingCache "shmcb:logs/ssl_stapling(32768)"

# D√©sactiver les protocoles faibles
SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1
```

**Configuration Nginx additionnelle** :
```nginx
# OCSP Stapling
ssl_stapling on;
ssl_stapling_verify on;
ssl_trusted_certificate /etc/letsencrypt/live/site1.exemple.com/chain.pem;

# Session SSL
ssl_session_cache shared:SSL:50m;
ssl_session_timeout 1d;
ssl_session_tickets off;
```

---

## 6.2.5 Performance tuning

### Optimisation d'Apache

L'optimisation des performances d'Apache est cruciale pour servir efficacement de nombreux utilisateurs simultan√©s. Les principaux leviers d'optimisation concernent la gestion des processus, la m√©moire, et la configuration des modules.

#### Modules de performance (MPM - Multi-Processing Modules)

Apache propose diff√©rents MPM selon les besoins :

**1. MPM Prefork** (par d√©faut sur Debian) :
- Un processus par requ√™te
- Tr√®s stable mais plus gourmand en m√©moire
- Compatible avec tous les modules PHP

**2. MPM Worker** :
- Processus + threads
- Plus efficace en m√©moire
- Bon compromis performance/compatibilit√©

**3. MPM Event** :
- Le plus performant
- Gestion asynchrone des connexions
- Id√©al pour les sites avec beaucoup de connexions persistantes

#### V√©rifier et changer le MPM

```bash
# Voir le MPM actuel
apache2ctl -V | grep -i mpm

# Voir les MPM disponibles
apache2ctl -M | grep mpm

# D√©sactiver le MPM actuel et activer event
a2dismod mpm_prefork
a2enmod mpm_event

# Red√©marrer Apache
systemctl restart apache2
```

#### Configuration du MPM Event

```bash
# √âditer la configuration du MPM Event
nano /etc/apache2/mods-available/mpm_event.conf
```

**Configuration optimis√©e pour serveur avec 4GB RAM** :
```apache
<IfModule mpm_event_module>
    # Nombre de processus serveur au d√©marrage
    StartServers             3

    # Nombre minimum de processus inactifs
    MinSpareThreads          75

    # Nombre maximum de processus inactifs
    MaxSpareThreads          250

    # Nombre de threads par processus enfant
    ThreadsPerChild          25

    # Limite maximale de processus enfants
    MaxRequestWorkers        400

    # Nombre de connexions par processus avant recyclage
    MaxConnectionsPerChild   1000

    # Limite de requ√™tes simultan√©es
    AsyncRequestWorkerFactor 2
</IfModule>
```

**Explication pour d√©butants** :
- `StartServers` : Processus au d√©marrage (plus = d√©marrage plus rapide)
- `ThreadsPerChild` : Threads par processus (25 √ó 16 processus = 400 connexions max)
- `MaxRequestWorkers` : Connexions simultan√©es maximales
- `MaxConnectionsPerChild` : Recyclage des processus (√©vite les fuites m√©moire)

#### Optimisation de la m√©moire Apache

```bash
# Installer l'outil de monitoring m√©moire
apt install -y apache2-utils

# Cr√©er un script de monitoring
nano /usr/local/bin/apache-memory-usage
```

```bash
#!/bin/bash
# Script de surveillance m√©moire Apache

echo "=== UTILISATION M√âMOIRE APACHE ==="
echo "Date: $(date)"
echo

# Processus Apache actifs
PROCS=$(ps aux | grep apache2 | grep -v grep | wc -l)
echo "Processus Apache actifs: $PROCS"

# Utilisation m√©moire moyenne par processus
AVG_MEM=$(ps aux | grep apache2 | grep -v grep | awk '{sum+=$6; count++} END {if(count>0) print sum/count/1024 " MB"}')
echo "M√©moire moyenne par processus: $AVG_MEM"

# M√©moire totale utilis√©e par Apache
TOTAL_MEM=$(ps aux | grep apache2 | grep -v grep | awk '{sum+=$6} END {print sum/1024 " MB"}')
echo "M√©moire totale Apache: $TOTAL_MEM"

# Charge syst√®me
echo
echo "=== CHARGE SYST√àME ==="
uptime
echo
free -h
```

```bash
# Rendre le script ex√©cutable
chmod +x /usr/local/bin/apache-memory-usage

# Ex√©cuter le script
apache-memory-usage
```

#### Configuration du cache et compression

**Activation des modules de performance** :
```bash
# Modules essentiels pour la performance
a2enmod expires
a2enmod headers
a2enmod deflate
a2enmod cache
a2enmod cache_disk

# Red√©marrer Apache
systemctl restart apache2
```

**Configuration dans le Virtual Host** :
```bash
nano /etc/apache2/sites-available/site1.exemple.com-le-ssl.conf
```

```apache
<VirtualHost *:443>
    # ... configuration SSL existante

    # === OPTIMISATIONS PERFORMANCE ===

    # Compression Gzip
    <IfModule mod_deflate.c>
        # Activer la compression pour les types de fichiers texte
        AddOutputFilterByType DEFLATE text/plain
        AddOutputFilterByType DEFLATE text/html
        AddOutputFilterByType DEFLATE text/xml
        AddOutputFilterByType DEFLATE text/css
        AddOutputFilterByType DEFLATE application/xml
        AddOutputFilterByType DEFLATE application/xhtml+xml
        AddOutputFilterByType DEFLATE application/rss+xml
        AddOutputFilterByType DEFLATE application/javascript
        AddOutputFilterByType DEFLATE application/x-javascript
        AddOutputFilterByType DEFLATE application/json

        # Niveau de compression (1-9, 6 par d√©faut)
        DeflateCompressionLevel 6

        # Exclure les anciens navigateurs
        BrowserMatch ^Mozilla/4 gzip-only-text/html
        BrowserMatch ^Mozilla/4\.0[678] no-gzip
        BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
    </IfModule>

    # Cache navigateur
    <IfModule mod_expires.c>
        ExpiresActive On

        # Cache par type de fichier
        ExpiresByType image/jpg "access plus 1 year"
        ExpiresByType image/jpeg "access plus 1 year"
        ExpiresByType image/gif "access plus 1 year"
        ExpiresByType image/png "access plus 1 year"
        ExpiresByType image/webp "access plus 1 year"
        ExpiresByType text/css "access plus 1 month"
        ExpiresByType application/pdf "access plus 1 month"
        ExpiresByType text/javascript "access plus 1 month"
        ExpiresByType application/javascript "access plus 1 month"
        ExpiresByType application/x-javascript "access plus 1 month"
        ExpiresByType text/html "access plus 300 seconds"
        ExpiresByType application/json "access plus 300 seconds"

        # Cache par d√©faut
        ExpiresDefault "access plus 2 days"
    </IfModule>

    # Headers de performance
    <IfModule mod_headers.c>
        # Supprimer ETag (redondant avec Expires)
        Header unset ETag
        FileETag None

        # Cache pour les ressources statiques
        <FilesMatch "\.(ico|pdf|flv|jpg|jpeg|png|gif|webp|js|css|swf)$">
            Header set Cache-Control "max-age=31536000, public"
        </FilesMatch>

        # Ne pas cacher les pages dynamiques
        <FilesMatch "\.(php|cgi|pl|htm|html)$">
            Header set Cache-Control "max-age=0, private, no-store, no-cache, must-revalidate"
        </FilesMatch>
    </IfModule>

    # Optimisation des connexions Keep-Alive
    KeepAlive On
    MaxKeepAliveRequests 100
    KeepAliveTimeout 2
</VirtualHost>
```

### Optimisation de Nginx

Nginx est d√©j√† tr√®s performant par d√©faut, mais plusieurs optimisations peuvent am√©liorer ses performances.

#### Configuration globale optimis√©e

```bash
# √âditer la configuration principale
nano /etc/nginx/nginx.conf
```

```nginx
# Nombre de processus worker (g√©n√©ralement = nombre de CPU)
worker_processes auto;

# Limites syst√®me
worker_rlimit_nofile 65535;

events {
    # Mod√®le d'√©v√©nements efficace sous Linux
    use epoll;

    # Nombre de connexions par worker
    worker_connections 4096;

    # Accepter plusieurs connexions simultan√©ment
    multi_accept on;
}

http {
    # === OPTIMISATIONS DE BASE ===

    # Envoi de fichiers optimis√©
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;

    # Timeouts optimis√©s
    keepalive_timeout 30;
    keepalive_requests 1000;
    client_max_body_size 32m;
    client_body_timeout 12;
    client_header_timeout 12;
    send_timeout 10;

    # Buffers optimis√©s
    client_body_buffer_size 128k;
    client_header_buffer_size 1k;
    large_client_header_buffers 4 16k;
    output_buffers 1 32k;
    postpone_output 1460;

    # === COMPRESSION GZIP ===

    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_comp_level 6;
    gzip_proxied any;
    gzip_buffers 16 8k;
    gzip_http_version 1.1;

    # Types de fichiers √† compresser
    gzip_types
        text/plain
        text/css
        text/js
        text/xml
        text/javascript
        application/javascript
        application/xml+rss
        application/json
        application/xml
        image/svg+xml
        font/truetype
        font/opentype
        application/vnd.ms-fontobject;

    # === CACHE STATIQUE ===

    # Cache des m√©tadonn√©es des fichiers
    open_file_cache max=200000 inactive=20s;
    open_file_cache_valid 30s;
    open_file_cache_min_uses 2;
    open_file_cache_errors on;

    # === S√âCURIT√â ET PERFORMANCE ===

    # Masquer la version Nginx
    server_tokens off;

    # Headers de s√©curit√© globaux
    add_header X-Frame-Options SAMEORIGIN always;
    add_header X-Content-Type-Options nosniff always;
    add_header X-XSS-Protection "1; mode=block" always;

    # Rate limiting global
    limit_req_zone $binary_remote_addr zone=global:10m rate=10r/s;

    # Inclure les sites
    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/sites-enabled/*;
}
```

#### Configuration optimis√©e par site

```bash
nano /etc/nginx/sites-available/site1.exemple.com
```

```nginx
# Cache pour les fichiers statiques (optionnel)
proxy_cache_path /var/cache/nginx/site1 levels=1:2 keys_zone=site1_cache:10m max_size=100m inactive=60m use_temp_path=off;

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;

    server_name site1.exemple.com www.site1.exemple.com;
    root /var/www/site1.exemple.com/html;

    # Configuration SSL existante...

    # === OPTIMISATIONS SP√âCIFIQUES AU SITE ===

    # Rate limiting pour ce site
    limit_req zone=global burst=20 nodelay;

    # Logs optimis√©s (buffer les √©critures)
    access_log /var/www/site1.exemple.com/logs/access.log combined buffer=64k flush=5s;
    error_log /var/www/site1.exemple.com/logs/error.log warn;

    # Location principale
    location / {
        try_files $uri $uri/ =404;

        # Headers de s√©curit√© sp√©cifiques
        add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
    }

    # Optimisation pour les fichiers statiques
    location ~* \.(jpg|jpeg|png|gif|ico|svg|webp)$ {
        expires 1y;
        add_header Cache-Control "public, no-transform";
        add_header Vary "Accept-Encoding";

        # Compression d'images √† la vol√©e (n√©cessite module image_filter)
        # image_filter_buffer 2M;
        # image_filter_interlace on;

        # Logs d√©sactiv√©s pour les fichiers statiques
        access_log off;

        # R√©duction des syscalls
        try_files $uri =404;
    }

    # CSS et JavaScript
    location ~* \.(css|js)$ {
        expires 1M;
        add_header Cache-Control "public";
        add_header Vary "Accept-Encoding";
        access_log off;

        # Pr√©-compression gzip si fichiers .gz disponibles
        gzip_static on;
    }

    # Polices web
    location ~* \.(woff|woff2|ttf|otf|eot)$ {
        expires 1y;
        add_header Cache-Control "public";
        add_header Access-Control-Allow-Origin "*";
        access_log off;
    }

    # Bloquer l'acc√®s aux fichiers syst√®me
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }

    # Bloquer les fichiers de backup
    location ~* \.(bak|backup|old|tmp)$ {
        deny all;
    }
}

# Redirection HTTP vers HTTPS optimis√©e
server {
    listen 80;
    listen [::]:80;
    server_name site1.exemple.com www.site1.exemple.com;

    # Redirection permanente vers HTTPS
    return 301 https://site1.exemple.com$request_uri;
}
```

### Monitoring et m√©triques de performance

#### Installation d'outils de monitoring

```bash
# Installer les outils de surveillance
apt install -y htop iotop nethogs ncdu

# Outils sp√©cifiques web
apt install -y apache2-utils  # ab (Apache Bench)
apt install -y curl wrk       # Tests de charge
```

#### Tests de performance avec Apache Bench

```bash
# Test basique : 1000 requ√™tes, 10 connexions simultan√©es
ab -n 1000 -c 10 https://site1.exemple.com/

# Test avec cookies
ab -n 1000 -c 10 -C "session=abc123" https://site1.exemple.com/

# Test avec headers personnalis√©s
ab -n 1000 -c 10 -H "Accept-Encoding: gzip,deflate" https://site1.exemple.com/

# Test de mont√©e en charge progressive
for concurrent in 1 5 10 20 50; do
    echo "Test avec $concurrent connexions simultan√©es:"
    ab -n 100 -c $concurrent https://site1.exemple.com/ | grep "Requests per second"
    sleep 2
done
```

#### Configuration du monitoring Nginx

**Activer le module status** :
```bash
nano /etc/nginx/sites-available/status
```

```nginx
server {
    listen 127.0.0.1:8080;
    server_name localhost;

    access_log off;

    location /nginx_status {
        stub_status on;
        allow 127.0.0.1;
        deny all;
    }

    location /server-info {
        return 200 "Nginx Performance Monitor\n\nServer: $hostname\nTime: $time_iso8601\nConnections: Active $connections_active, Reading $connections_reading, Writing $connections_writing, Waiting $connections_waiting\n";
        add_header Content-Type text/plain;
    }
}
```

```bash
# Activer le monitoring
ln -s /etc/nginx/sites-available/status /etc/nginx/sites-enabled/
systemctl reload nginx

# Tester
curl http://127.0.0.1:8080/nginx_status
```

#### Script de surveillance automatique

```bash
nano /usr/local/bin/web-server-monitor
```

```bash
#!/bin/bash
# Script de surveillance serveur web

LOG_FILE="/var/log/web-monitor.log"
ALERT_EMAIL="admin@exemple.com"

# Fonction de log avec timestamp
log_message() {
    echo "$(date '+%Y-%m-%d %H:%M:%S') - $1" >> $LOG_FILE
}

# V√©rifier Apache (si install√©)
if systemctl is-active --quiet apache2; then
    # Connexions actives Apache
    APACHE_PROCS=$(pgrep apache2 | wc -l)
    APACHE_MEM=$(ps aux | grep apache2 | grep -v grep | awk '{sum+=$6} END {print sum/1024}')

    log_message "Apache - Processus: $APACHE_PROCS, M√©moire: ${APACHE_MEM}MB"

    # Alerte si plus de 50 processus Apache
    if [ $APACHE_PROCS -gt 50 ]; then
        log_message "ALERTE: Trop de processus Apache ($APACHE_PROCS)"
        # Envoyer email (si mail configur√©)
        # echo "Alerte Apache: $APACHE_PROCS processus" | mail -s "Serveur Web Alert" $ALERT_EMAIL
    fi
fi

# V√©rifier Nginx (si install√©)
if systemctl is-active --quiet nginx; then
    # Statistiques Nginx
    NGINX_STATUS=$(curl -s http://127.0.0.1:8080/nginx_status 2>/dev/null)
    if [ $? -eq 0 ]; then
        ACTIVE_CONN=$(echo "$NGINX_STATUS" | grep "Active connections" | awk '{print $3}')
        log_message "Nginx - Connexions actives: $ACTIVE_CONN"
    fi
fi

# V√©rifier l'espace disque
DISK_USAGE=$(df /var/www | tail -1 | awk '{print $5}' | sed 's/%//')
if [ $DISK_USAGE -gt 80 ]; then
    log_message "ALERTE: Espace disque faible ($DISK_USAGE%)"
fi

# V√©rifier la charge syst√®me
LOAD=$(uptime | awk '{print $(NF-2)}' | sed 's/,//')
if (( $(echo "$LOAD > 2.0" | bc -l) )); then
    log_message "ALERTE: Charge syst√®me √©lev√©e ($LOAD)"
fi
```

```bash
# Rendre le script ex√©cutable
chmod +x /usr/local/bin/web-server-monitor

# Ajouter √† la crontab pour ex√©cution toutes les 5 minutes
crontab -e
```

```bash
# Surveillance serveur web toutes les 5 minutes
*/5 * * * * /usr/local/bin/web-server-monitor

# Nettoyage des logs anciens chaque semaine
0 2 * * 0 find /var/log -name "*.log" -mtime +30 -delete
```

### Optimisation syst√®me globale

#### Configuration du kernel pour serveur web

```bash
# Optimisations r√©seau dans sysctl
nano /etc/sysctl.d/99-web-performance.conf
```

```bash
# === OPTIMISATIONS R√âSEAU ===

# Augmenter les limites de connexions
net.core.somaxconn = 65535
net.core.netdev_max_backlog = 5000

# Optimiser les buffers r√©seau
net.core.rmem_default = 262144
net.core.rmem_max = 16777216
net.core.wmem_default = 262144
net.core.wmem_max = 16777216

# Optimiser TCP
net.ipv4.tcp_rmem = 4096 65536 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
net.ipv4.tcp_congestion_control = bbr
net.ipv4.tcp_slow_start_after_idle = 0

# R√©utilisation des connexions TCP
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_fin_timeout = 15

# S√©curit√© r√©seau
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.icmp_echo_ignore_broadcasts = 1

# === OPTIMISATIONS SYST√àME ===

# Augmenter les limites de fichiers
fs.file-max = 2097152

# Optimiser la m√©moire virtuelle
vm.swappiness = 10
vm.dirty_ratio = 15
vm.dirty_background_ratio = 5
```

```bash
# Appliquer les modifications
sysctl -p /etc/sysctl.d/99-web-performance.conf
```

#### Optimisation des limites utilisateur

```bash
# Augmenter les limites pour www-data
nano /etc/security/limits.d/www-data.conf
```

```bash
# Limites pour l'utilisateur web
www-data soft nofile 65535
www-data hard nofile 65535
www-data soft nproc 32768
www-data hard nproc 32768

# Limites pour root (administration)
root soft nofile 65535
root hard nofile 65535
```

### Tests de performance complets

#### Script de benchmark automatis√©

```bash
nano /usr/local/bin/web-performance-test
```

```bash
#!/bin/bash
# Script de test de performance complet

SITE_URL="https://site1.exemple.com"
REPORT_FILE="/var/log/performance-test-$(date +%Y%m%d-%H%M%S).log"

echo "=== TEST DE PERFORMANCE WEB ===" > $REPORT_FILE
echo "Site: $SITE_URL" >> $REPORT_FILE
echo "Date: $(date)" >> $REPORT_FILE
echo "Serveur: $(hostname)" >> $REPORT_FILE
echo >> $REPORT_FILE

# Test de connectivit√©
echo "=== TEST CONNECTIVIT√â ===" >> $REPORT_FILE
curl -o /dev/null -s -w "Temps de connexion: %{time_connect}s\nTemps total: %{time_total}s\nCode r√©ponse: %{http_code}\n" $SITE_URL >> $REPORT_FILE
echo >> $REPORT_FILE

# Test Apache Bench - Charge l√©g√®re
echo "=== TEST CHARGE L√âG√àRE (10 connexions simultan√©es) ===" >> $REPORT_FILE
ab -n 100 -c 10 $SITE_URL/ 2>&1 | grep -E "(Requests per second|Time per request|Transfer rate)" >> $REPORT_FILE
echo >> $REPORT_FILE

# Test Apache Bench - Charge moyenne
echo "=== TEST CHARGE MOYENNE (50 connexions simultan√©es) ===" >> $REPORT_FILE
ab -n 500 -c 50 $SITE_URL/ 2>&1 | grep -E "(Requests per second|Time per request|Transfer rate)" >> $REPORT_FILE
echo >> $REPORT_FILE

# Test des ressources statiques
echo "=== TEST RESSOURCES STATIQUES ===" >> $REPORT_FILE
if curl -s $SITE_URL/ | grep -q "\.css\|\.js\|\.png\|\.jpg"; then
    echo "Ressources statiques d√©tect√©es" >> $REPORT_FILE
    # Test d'un fichier CSS s'il existe
    CSS_FILE=$(curl -s $SITE_URL/ | grep -o 'href="[^"]*\.css"' | head -1 | cut -d'"' -f2)
    if [ ! -z "$CSS_FILE" ]; then
        FULL_CSS_URL="$SITE_URL$CSS_FILE"
        ab -n 100 -c 10 $FULL_CSS_URL 2>&1 | grep "Requests per second" >> $REPORT_FILE
    fi
fi
echo >> $REPORT_FILE

# √âtat du syst√®me pendant le test
echo "=== √âTAT SYST√àME ===" >> $REPORT_FILE
free -h >> $REPORT_FILE
echo >> $REPORT_FILE
df -h >> $REPORT_FILE
echo >> $REPORT_FILE

echo "Rapport g√©n√©r√©: $REPORT_FILE"
```

```bash
chmod +x /usr/local/bin/web-performance-test

# Ex√©cuter le test
web-performance-test
```

### R√©sum√© des optimisations

#### Checklist de performance

**‚úÖ Apache** :
- [ ] MPM Event activ√© et configur√©
- [ ] Modules de compression activ√©s (deflate)
- [ ] Cache navigateur configur√© (expires, headers)
- [ ] Keep-Alive optimis√©
- [ ] Surveillance m√©moire en place

**‚úÖ Nginx** :
- [ ] Worker processes = nombre de CPU
- [ ] Compression gzip activ√©e
- [ ] Cache des fichiers statiques configur√©
- [ ] Buffers et timeouts optimis√©s
- [ ] Rate limiting configur√©

**‚úÖ Syst√®me** :
- [ ] Param√®tres kernel optimis√©s (sysctl)
- [ ] Limites utilisateur augment√©es
- [ ] Monitoring automatique configur√©
- [ ] Tests de performance automatis√©s

#### Indicateurs de performance √† surveiller

**M√©triques serveur** :
- Requ√™tes par seconde (RPS)
- Temps de r√©ponse moyen
- Utilisation CPU et m√©moire
- Nombre de connexions simultan√©es

**M√©triques utilisateur** :
- Temps de chargement page
- First Contentful Paint (FCP)
- Time to Interactive (TTI)
- Core Web Vitals (LCP, FID, CLS)

#### Outils de monitoring recommand√©s

**Gratuits** :
- Apache Bench (ab) - Tests de charge
- htop/top - Surveillance syst√®me
- netstat/ss - Connexions r√©seau
- Google PageSpeed Insights - Performance utilisateur

**Avanc√©s** (pour plus tard) :
- Prometheus + Grafana - M√©triques temps r√©el
- New Relic / DataDog - APM professionnel
- GTmetrix - Tests de performance complets

---

## Conclusion du Module 6.2

### Ce que nous avons accompli

‚úÖ **Installation et configuration** d'Apache et Nginx
‚úÖ **Virtual Hosts** multiples avec isolation compl√®te
‚úÖ **SSL/TLS** avec certificats Let's Encrypt automatiques
‚úÖ **Optimisations performance** syst√®me et application
‚úÖ **Monitoring** et surveillance automatique

### Points cl√©s √† retenir

- **S√©curit√© first** : HTTPS obligatoire, headers de s√©curit√©
- **Performance** : Compression, cache, optimisations r√©seau
- **Surveillance** : Monitoring continu des performances
- **Automatisation** : Certificats et tests automatis√©s

### Pr√©requis pour la suite

Avant de passer au Module 6.3 (Bases de donn√©es), v√©rifiez que :
- Vos sites web sont accessibles en HTTPS
- Les performances sont optimales (>100 RPS)
- Le monitoring fonctionne correctement
- Les certificats se renouvellent automatiquement

**Votre serveur web est maintenant pr√™t pour h√©berger des applications web professionnelles !**

---

*Prochaine √©tape : Module 6.3 - Configuration des bases de donn√©es (MySQL/PostgreSQL)*

‚è≠Ô∏è
