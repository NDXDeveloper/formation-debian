üîù Retour au [Sommaire](/SOMMAIRE.md)

# 3.1 Syst√®me de fichiers

Le syst√®me de fichiers est l'√©pine dorsale de votre syst√®me Debian. Comprendre son organisation et savoir le manipuler efficacement est essentiel pour tout administrateur syst√®me, m√™me d√©butant.

## 3.1.1 Structure des r√©pertoires Linux/Debian

### Qu'est-ce que la hi√©rarchie des r√©pertoires ?

Contrairement √† Windows qui utilise des lettres de lecteur (C:, D:, etc.), Linux organise tous les fichiers dans une seule hi√©rarchie en forme d'arbre qui commence √† la racine `/`.

### Les r√©pertoires essentiels

Voici les r√©pertoires principaux que vous rencontrerez sur votre syst√®me Debian :

#### **/ (racine)**
- Point de d√©part de toute l'arborescence
- √âquivalent du "C:\" sous Windows, mais pour tout le syst√®me

#### **/home**
- Contient les dossiers personnels de tous les utilisateurs
- Votre dossier personnel se trouve dans `/home/votre_nom_utilisateur`
- Comparable au dossier "Utilisateurs" de Windows

```bash
# Exemple : si votre nom d'utilisateur est "marie"
/home/marie/          # Votre dossier personnel
/home/marie/Documents # Vos documents
/home/marie/Bureau    # Votre bureau
```

#### **/etc**
- **Et**c **c**etera - "tout le reste"
- Contient tous les fichiers de configuration du syst√®me
- Tr√®s important : ne modifiez ces fichiers qu'en connaissance de cause !

```bash
/etc/passwd          # Liste des utilisateurs
/etc/group           # Liste des groupes
/etc/hostname        # Nom de votre machine
/etc/hosts           # Correspondance nom/adresse IP
/etc/apt/sources.list # Sources des paquets
```

#### **/usr**
- **Us**e**r** programs - programmes utilisateur
- Contient la plupart des logiciels install√©s
- Sous-r√©pertoires importants :
  - `/usr/bin` : programmes principaux
  - `/usr/lib` : biblioth√®ques partag√©es
  - `/usr/share` : donn√©es partag√©es (documentation, ic√¥nes)

#### **/var**
- **Var**iable data - donn√©es variables
- Stocke les fichiers qui changent pendant le fonctionnement
- Exemples :
  - `/var/log` : fichiers de journalisation (logs)
  - `/var/cache` : cache des applications
  - `/var/lib` : donn√©es d'√©tat des programmes

#### **/tmp**
- Fichiers temporaires
- Vid√© automatiquement au red√©marrage
- Accessible en √©criture √† tous les utilisateurs

#### **/opt**
- **Opt**ional software - logiciels optionnels
- Programmes install√©s manuellement (hors gestionnaire de paquets)

#### **/boot**
- Fichiers n√©cessaires au d√©marrage du syst√®me
- Noyau Linux, initramfs, configuration du bootloader

#### **/dev**
- **Dev**ices - p√©riph√©riques
- Fichiers sp√©ciaux repr√©sentant le mat√©riel
- Exemples : `/dev/sda1` (premier disque dur), `/dev/tty1` (terminal 1)

#### **/proc** et **/sys**
- Syst√®mes de fichiers virtuels
- Interfaces avec le noyau Linux
- Contiennent des informations sur les processus et le mat√©riel

### Navigation dans l'arborescence

```bash
# Afficher le r√©pertoire courant
pwd

# Lister le contenu d'un r√©pertoire
ls /etc

# Se d√©placer dans l'arborescence
cd /home/votre_nom    # Aller dans votre dossier personnel
cd ..                 # Remonter d'un niveau
cd /                  # Aller √† la racine
cd ~                  # Retourner dans votre dossier personnel
```

## 3.1.2 Permissions et propri√©t√©s (ACL avanc√©es)

### Comprendre les permissions de base

Chaque fichier et r√©pertoire poss√®de des permissions qui d√©finissent qui peut faire quoi.

#### Les types de permissions

1. **r** (read) : lire le contenu
2. **w** (write) : modifier le contenu
3. **x** (execute) : ex√©cuter le fichier ou traverser le r√©pertoire

#### Les cat√©gories d'utilisateurs

1. **u** (user) : propri√©taire du fichier
2. **g** (group) : groupe propri√©taire
3. **o** (others) : tous les autres utilisateurs
4. **a** (all) : tout le monde

#### Afficher les permissions

```bash
# Affichage d√©taill√© avec permissions
ls -l

# Exemple de sortie :
# -rw-r--r-- 1 marie users 1024 jan 15 10:30 mon_fichier.txt
# drwxr-xr-x 2 marie users 4096 jan 15 09:15 mon_dossier
```

**D√©cryptage de `-rw-r--r--` :**
- Premier caract√®re : type de fichier (`-` = fichier, `d` = r√©pertoire)
- Caract√®res 2-4 : permissions du propri√©taire (`rw-` = lecture+√©criture)
- Caract√®res 5-7 : permissions du groupe (`r--` = lecture seule)
- Caract√®res 8-10 : permissions des autres (`r--` = lecture seule)

#### Modifier les permissions avec chmod

**M√©thode symbolique (recommand√©e pour d√©buter) :**

```bash
# Donner la permission d'ex√©cution au propri√©taire
chmod u+x mon_script.sh

# Retirer la permission d'√©criture au groupe
chmod g-w mon_fichier.txt

# Donner lecture et √©criture √† tous
chmod a+rw mon_fichier.txt

# Plusieurs modifications simultan√©es
chmod u+x,g-w,o-r mon_fichier.txt
```

**M√©thode num√©rique (octale) :**

Chaque permission a une valeur :
- `r` = 4
- `w` = 2
- `x` = 1

```bash
# 755 = rwxr-xr-x (propri√©taire: 7=4+2+1, groupe: 5=4+1, autres: 5=4+1)
chmod 755 mon_script.sh

# 644 = rw-r--r-- (propri√©taire: 6=4+2, groupe: 4, autres: 4)
chmod 644 mon_fichier.txt

# 600 = rw------- (seul le propri√©taire peut lire/√©crire)
chmod 600 mon_fichier_prive.txt
```

#### Changer le propri√©taire avec chown

```bash
# Changer le propri√©taire
sudo chown marie mon_fichier.txt

# Changer propri√©taire et groupe
sudo chown marie:users mon_fichier.txt

# Changer r√©cursivement tout un dossier
sudo chown -R marie:users /home/marie/projet
```

### ACL avanc√©es (Access Control Lists)

Les ACL permettent des permissions plus fines que le syst√®me traditionnel.

#### V√©rifier si les ACL sont support√©es

```bash
# V√©rifier les ACL sur un fichier
getfacl mon_fichier.txt
```

#### D√©finir des ACL

```bash
# Donner permission de lecture √† l'utilisateur "jean"
setfacl -m u:jean:r mon_fichier.txt

# Donner permission compl√®te au groupe "admin"
setfacl -m g:admin:rwx mon_dossier

# D√©finir des permissions par d√©faut pour un r√©pertoire
setfacl -d -m g:developpeurs:rw /home/projets
```

#### Supprimer des ACL

```bash
# Supprimer une ACL sp√©cifique
setfacl -x u:jean mon_fichier.txt

# Supprimer toutes les ACL
setfacl -b mon_fichier.txt
```

## 3.1.3 Montage et d√©montage

### Qu'est-ce que le montage ?

Le montage consiste √† rendre un syst√®me de fichiers (disque dur, cl√© USB, partition) accessible dans l'arborescence Linux.

### Comprendre les points de montage

Un point de montage est un r√©pertoire o√π sera "accroch√©" le contenu d'un syst√®me de fichiers externe.

```bash
# Cr√©er un point de montage
sudo mkdir /media/ma_cle_usb

# Le contenu de la cl√© USB sera visible dans ce r√©pertoire apr√®s montage
```

### Identifier les p√©riph√©riques

```bash
# Lister tous les disques et partitions
lsblk

# Afficher les informations d√©taill√©es
sudo fdisk -l

# Exemple de sortie lsblk :
# sda      8:0    0  500G  0 disk
# ‚îú‚îÄsda1   8:1    0  100M  0 part /boot
# ‚îú‚îÄsda2   8:2    0  450G  0 part /
# ‚îî‚îÄsda3   8:3    0   50G  0 part /home
# sdb      8:16   1    8G  0 disk
# ‚îî‚îÄsdb1   8:17   1    8G  0 part      <- Cl√© USB non mont√©e
```

### Montage manuel

```bash
# Monter une cl√© USB
sudo mount /dev/sdb1 /media/ma_cle_usb

# Monter avec des options sp√©cifiques
sudo mount -t ntfs -o rw,umask=000 /dev/sdb1 /media/ma_cle_usb

# V√©rifier le montage
df -h
mount | grep sdb1
```

### D√©montage

```bash
# D√©monter proprement
sudo umount /media/ma_cle_usb

# Forcer le d√©montage (attention !)
sudo umount -f /media/ma_cle_usb

# D√©monter par p√©riph√©rique
sudo umount /dev/sdb1
```

### Montage automatique avec /etc/fstab

Le fichier `/etc/fstab` d√©finit les montages automatiques au d√©marrage.

```bash
# √âditer le fichier fstab
sudo nano /etc/fstab

# Exemple d'entr√©e :
# /dev/sdb1 /media/stockage ext4 defaults,user,noauto 0 2
```

**Explication des colonnes :**
1. P√©riph√©rique ou UUID
2. Point de montage
3. Type de syst√®me de fichiers
4. Options de montage
5. Sauvegarde (0=non, 1=oui)
6. V√©rification fsck (0=non, 1=racine, 2=autres)

**Options courantes :**
- `defaults` : options par d√©faut
- `user` : permet aux utilisateurs de monter
- `noauto` : ne pas monter automatiquement au boot
- `ro` : lecture seule
- `rw` : lecture-√©criture

### Montage moderne avec udisks2

```bash
# Monter (pour les utilisateurs normaux)
udisksctl mount -b /dev/sdb1

# D√©monter
udisksctl unmount -b /dev/sdb1
```

## 3.1.4 Liens symboliques et physiques

### Qu'est-ce qu'un lien ?

Un lien permet d'acc√©der au m√™me fichier depuis plusieurs emplacements dans l'arborescence.

### Liens physiques (hard links)

Un lien physique est une entr√©e suppl√©mentaire dans le syst√®me de fichiers qui pointe vers les m√™mes donn√©es.

#### Caract√©ristiques des liens physiques :
- Partagent le m√™me inode (num√©ro d'identification unique)
- Suppression : le fichier n'est vraiment supprim√© que quand tous les liens sont supprim√©s
- Ne peuvent pas traverser les syst√®mes de fichiers
- Ne fonctionnent pas avec les r√©pertoires

```bash
# Cr√©er un lien physique
ln fichier_original.txt lien_physique.txt

# V√©rifier les liens (m√™me num√©ro d'inode)
ls -li fichier_original.txt lien_physique.txt

# Compter les liens d'un fichier
stat fichier_original.txt
```

### Liens symboliques (soft links ou symlinks)

Un lien symbolique est un fichier sp√©cial qui contient le chemin vers un autre fichier.

#### Caract√©ristiques des liens symboliques :
- Fichier ind√©pendant avec son propre inode
- Peut pointer vers des fichiers ou r√©pertoires
- Peut traverser les syst√®mes de fichiers
- Devient "cass√©" si le fichier cible est supprim√©

```bash
# Cr√©er un lien symbolique
ln -s /chemin/vers/fichier_original.txt lien_symbolique.txt

# Lien vers un r√©pertoire
ln -s /home/marie/Documents /home/marie/Bureau/Mes_Documents

# Lien relatif (recommand√©)
ln -s ../Documents/projet lien_vers_projet
```

### Gestion des liens

```bash
# Identifier les liens symboliques
ls -l  # Affiche -> vers quoi pointe le lien

# Trouver tous les liens physiques d'un fichier
find / -samefile fichier_original.txt 2>/dev/null

# Trouver les liens symboliques cass√©s
find /home -type l -exec test ! -e {} \; -print 2>/dev/null

# Supprimer un lien (ne supprime pas le fichier original)
rm lien_symbolique.txt
rm lien_physique.txt
```

### Cas d'usage pratiques

#### Liens symboliques vers des applications

```bash
# Rendre une application accessible globalement
sudo ln -s /opt/mon_application/bin/mon_app /usr/local/bin/mon_app
```

#### Liens pour la gestion de configuration

```bash
# Pointer vers diff√©rentes versions de configuration
ln -s /etc/apache2/sites-available/prod.conf /etc/apache2/sites-enabled/site.conf
```

#### Liens pour √©conomiser l'espace

```bash
# Partager des gros fichiers entre projets
ln gros_fichier.iso /autre/projet/gros_fichier.iso  # Lien physique
```

### Diff√©rences importantes

| Aspect | Lien physique | Lien symbolique |
|--------|---------------|-----------------|
| Traverse les syst√®mes de fichiers | Non | Oui |
| Fonctionne avec les r√©pertoires | Non | Oui |
| Survit √† la suppression de l'original | Oui | Non (devient cass√©) |
| Taille | M√™me que l'original | Petite (chemin uniquement) |
| Performance | L√©g√®rement meilleure | L√©g√®rement moins bonne |

### Conseils pratiques

1. **Utilisez les liens symboliques** dans la plupart des cas (plus flexibles)
2. **Pr√©f√©rez les chemins relatifs** pour les liens symboliques (plus portables)
3. **V√©rifiez r√©guli√®rement** les liens cass√©s
4. **Documentez vos liens** importants pour faciliter la maintenance

‚è≠Ô∏è
